
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" /><script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-139058009-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Help on Python package (pygtftk) &#8212; gtftk 1.1.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The pygtftk.bwig.bw_coverage module" href="bwig_coverage.html" />
    <link rel="prev" title="Commands from section ‘miscellaneous’" href="miscellaneous.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The pygtftk.bwig.bw_coverage module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="miscellaneous.html" title="Commands from section ‘miscellaneous’"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 1.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="help-on-python-package-pygtftk">
<h1>Help on Python package (pygtftk)<a class="headerlink" href="#help-on-python-package-pygtftk" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pygtftk.gtf_interface">
<span id="the-gtf-class"></span><h2>The GTF class<a class="headerlink" href="#module-pygtftk.gtf_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of GTF object.</p>
<p>When using gtfk a GTF object methods may return:</p>
<blockquote>
<div><ul class="simple">
<li><p>a GTF object (a representation of a GTF file).</p></li>
<li><p>a TAB object (a representation of a tabulated file).</p></li>
<li><p>a FASTA object (a representation of a fasta file).</p></li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pygtftk.gtf_interface.GTF">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.gtf_interface.</code><code class="sig-name descname">GTF</code><span class="sig-paren">(</span><em class="sig-param">input_obj=None</em>, <em class="sig-param">check_ensembl_format=True</em>, <em class="sig-param">new_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface to a GTF file. This object returns a GTF, TAB
or FASTA object.</p>
<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_column">
<code class="sig-name descname">add_attr_column</code><span class="sig-paren">(</span><em class="sig-param">input_file=None</em>, <em class="sig-param">new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to each line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> – a single column file with nrow(GTF_DATA) lines. File lines should be sorted according to the GTF_DATA object. Lines for which a new key should not be added should contain “?”.</p></li>
<li><p><strong>new_key</strong> – name of the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_col</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_column</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a_col</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">]</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_dict">
<code class="sig-name descname">add_attr_from_dict</code><span class="sig-paren">(</span><em class="sig-param">feat='*'</em>, <em class="sig-param">key='transcript_id'</em>, <em class="sig-param">a_dict=None</em>, <em class="sig-param">new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target feature. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key used for joining (e.g ‘transcript_id’).</p></li>
<li><p><strong>a_dict</strong> – key and values will be used to call add_attr_from_file.</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_dict</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">a_dict</span><span class="o">=</span><span class="n">a_dict</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;exon_nb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id,exon_nb&quot;</span><span class="p">,</span> <span class="n">as_dict_of_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_file">
<code class="sig-name descname">add_attr_from_file</code><span class="sig-paren">(</span><em class="sig-param">feat=None</em>, <em class="sig-param">key='transcript_id'</em>, <em class="sig-param">new_key='new_key'</em>, <em class="sig-param">inputfile=None</em>, <em class="sig-param">has_header=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target feature. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key used for joining (i.e the key corresponding to value provided in the file).</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
<li><p><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</p></li>
<li><p><strong>has_header</strong> – Whether the file to join contains column names.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_list">
<code class="sig-name descname">add_attr_from_list</code><span class="sig-paren">(</span><em class="sig-param">feat=None</em>, <em class="sig-param">key='transcript_id'</em>, <em class="sig-param">key_value=()</em>, <em class="sig-param">new_key='new_key'</em>, <em class="sig-param">new_key_value=()</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target features. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key to use for joining (e.g ‘transcript_id’).</p></li>
<li><p><strong>key_value</strong> – The values for the key (e.g [‘tx_1’, ‘tx_2’,…,’tx_n’])</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
<li><p><strong>new_key_value</strong> – A name for the novel key (e.g [‘val_tx_1’, ‘val_tx_2’,…,’val_tx_n’]).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0001&quot;</span><span class="p">,</span> <span class="s2">&quot;G0002&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;0.8&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0002&quot;</span><span class="p">,</span> <span class="s2">&quot;G0001&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="n">key_value</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_value</span><span class="p">))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_matrix_file">
<code class="sig-name descname">add_attr_from_matrix_file</code><span class="sig-paren">(</span><em class="sig-param">feat=None</em>, <em class="sig-param">key='transcript_id'</em>, <em class="sig-param">inputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_matrix_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF file. Expect a matrix with row names as target keys column names as novel key and each cell as value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target features. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key to use for joining (i.e the key corresponding to value provided in the file).</p></li>
<li><p><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join_mat&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_matrix_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S1&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S2&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;S1,S2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_to_pos">
<code class="sig-name descname">add_attr_to_pos</code><span class="sig-paren">(</span><em class="sig-param">input_file=None</em>, <em class="sig-param">new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_to_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to specific lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> – a two column file. First column contains the position/line (zero-based numbering). Second, the value to be added for ‘new_key’.</p></li>
<li><p><strong>new_key</strong> – name of the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_col</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;tab&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_to_pos</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a_col</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;AAA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BBB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CCC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_exon_number">
<code class="sig-name descname">add_exon_number</code><span class="sig-paren">(</span><em class="sig-param">key='exon_nbr'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_exon_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Add exon number to exons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key name to use for exon number.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_exon_number</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0003T001&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_prefix">
<code class="sig-name descname">add_prefix</code><span class="sig-paren">(</span><em class="sig-param">feat='*'</em>, <em class="sig-param">key=None</em>, <em class="sig-param">txt=None</em>, <em class="sig-param">suffix=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a prefix to an attribute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target features (default to all).</p></li>
<li><p><strong>key</strong> – The target key.</p></li>
<li><p><strong>txt</strong> – The string to be added as a prefix.</p></li>
<li><p><strong>suffix</strong> – If True append txt string as a suffix.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.convert_to_ensembl">
<code class="sig-name descname">convert_to_ensembl</code><span class="sig-paren">(</span><em class="sig-param">check_gene_chr=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.convert_to_ensembl" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a GTF file to ensembl format. This method will add gene
and transcript features if not encountered in the GTF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>check_gene_chr</strong> – By default the function raise an error if several chromosomes are associated with the same gene_id.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene,transcript&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">convert_to_ensembl</span><span class="p">())</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.del_attr">
<code class="sig-name descname">del_attr</code><span class="sig-paren">(</span><em class="sig-param">feat='*'</em>, <em class="sig-param">keys=None</em>, <em class="sig-param">force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.del_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an attributes from the GTF file..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target feature.</p></li>
<li><p><strong>keys</strong> – comma-separated list or list of target keys.</p></li>
<li><p><strong>force</strong> – If True, transcript_id and gene_id can be deleted.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,exon_id,ccds_id&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.eval_numeric">
<code class="sig-name descname">eval_numeric</code><span class="sig-paren">(</span><em class="sig-param">bool_exp=None</em>, <em class="sig-param">na_omit=('.'</em>, <em class="sig-param">'?')</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.eval_numeric" title="Permalink to this definition">¶</a></dt>
<dd><p>Test numeric values. Select lines using a boolean operation on attributes.
The boolean expression must contain attributes enclosed with braces.
Example: “cDNA_length &gt; 200 and tx_genomic_length &gt; 2000”.
Note that one can refers to the name of the first columns of the gtf using e.g:
start, end, score or frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bool_exp</strong> – A boolean test.</p></li>
<li><p><strong>na_omit</strong> – Any line for which one of the tested value is in this list wont be evaluated (e.g. (“.”, “?”)).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0001T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0002T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0003T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0004T001&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">,</span><span class="s2">&quot;11&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;test &gt; 2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2 and start &lt; 180 and start &gt;= 50&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2 and start &lt; 180 and start &gt; 50&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s1">&#39;feature&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;score == 0&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;start == 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;start != 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;54801291&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and start == 53802771&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and (start == 53802771 or start == 53806156)&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;phase &gt; 0 and phase &lt; 2&quot;</span><span class="p">,</span> <span class="n">na_omit</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.extract_data">
<code class="sig-name descname">extract_data</code><span class="sig-paren">(</span><em class="sig-param">keys=None</em>, <em class="sig-param">as_list=False</em>, <em class="sig-param">zero_based=False</em>, <em class="sig-param">no_na=False</em>, <em class="sig-param">as_dict_of_values=False</em>, <em class="sig-param">as_dict_of_lists=False</em>, <em class="sig-param">as_dict=False</em>, <em class="sig-param">as_dict_of_merged_list=False</em>, <em class="sig-param">nr=False</em>, <em class="sig-param">hide_undef=False</em>, <em class="sig-param">as_list_of_list=False</em>, <em class="sig-param">default_val=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attribute values into containers of various types. Note that in case dict are requested, keys are force to no_na.</p>
<p>Note: no_na, hide_undef, nr, zero_based are not applied in case a tab object is returned (default).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – The name of the basic or extended attributes.</p></li>
<li><p><strong>as_list</strong> – if true returns values for the first requested key as a list.</p></li>
<li><p><strong>no_na</strong> – Discard ‘.’ (i.e undefined value).</p></li>
<li><p><strong>as_dict</strong> – if true returns a dict (where the key corresponds to values for the first requested key and values are set to 1). Note that ‘.’ won’t be set as a key (no need to use no_na).</p></li>
<li><p><strong>as_dict_of_values</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to value encountered for the second requested key).</p></li>
<li><p><strong>as_dict_of_lists</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the last encountered list of other elements).</p></li>
<li><p><strong>as_dict_of_merged_list</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the list of other elements encountered throughout any line).</p></li>
<li><p><strong>as_list_of_list</strong> – if True returns a list for each line.</p></li>
<li><p><strong>nr</strong> – in case a as_list or as_list_of_list is chosen, return a non redondant list.</p></li>
<li><p><strong>hide_undef</strong> – if hide_undef, then records for which the key does not exists (value = “?”) are set to are discarded.</p></li>
<li><p><strong>zero_based</strong> – If set to True, the start position will be start-1.</p></li>
<li><p><strong>default_val</strong> – The default value for the dict if as_dict is chosen.</p></li>
</ul>
</dd>
</dl>
<p>Note: hide_undef and no_na are not supported when a TAB object is returned (default).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_tab</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_tab</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.extract_data_iter_list">
<code class="sig-name descname">extract_data_iter_list</code><span class="sig-paren">(</span><em class="sig-param">keys=None</em>, <em class="sig-param">zero_based=False</em>, <em class="sig-param">nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data_iter_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attributes of any type and returns an iterator of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – The name of the basic or extended attributes.</p></li>
<li><p><strong>zero_based</strong> – If set to True, the start position will be start-1.</p></li>
<li><p><strong>nr</strong> – if True, return a list with non redundant items.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;125&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">zero_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;124&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">26</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_3p_end">
<code class="sig-name descname">get_3p_end</code><span class="sig-paren">(</span><em class="sig-param">feat_type='transcript'</em>, <em class="sig-param">name='transcript_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">as_dict=False</em>, <em class="sig-param">more_name=()</em>, <em class="sig-param">feature_name=None</em>, <em class="sig-param">explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 3’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat_type</strong> – The feature type.</p></li>
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_id=G0001|exon_id=G0001T002E001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_5p_end">
<code class="sig-name descname">get_5p_end</code><span class="sig-paren">(</span><em class="sig-param">feat_type='transcript'</em>, <em class="sig-param">name='transcript_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">as_dict=False</em>, <em class="sig-param">more_name=()</em>, <em class="sig-param">one_based=False</em>, <em class="sig-param">feature_name=None</em>, <em class="sig-param">explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 5’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat_type</strong> – The feature type.</p></li>
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a tuple).</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;transcript_id=G0001T002|gene_id=G0001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_attr_list">
<code class="sig-name descname">get_attr_list</code><span class="sig-paren">(</span><em class="sig-param">add_basic=False</em>, <em class="sig-param">as_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible attributes from a GTF file..</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_basic</strong> – add basic attributes to the list. Won’t work if as_dict is True.</p></li>
<li><p><strong>as_dict</strong> – If True, returns a dict with the attribute names as key and number of occurence as values.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()])</span> <span class="o">==</span> <span class="s1">&#39;gtec&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_attr_value_list">
<code class="sig-name descname">get_attr_value_list</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">count=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_value_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible values taken by an attributes from a GTF file..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use.</p></li>
<li><p><strong>count</strong> – whether the number of occurences should be also returned (returns a list of list).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0010T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_chroms">
<code class="sig-name descname">get_chroms</code><span class="sig-paren">(</span><em class="sig-param">nr=False</em>, <em class="sig-param">as_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_chroms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chomosome/sequence ID from the GTF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> – True to get a non redondant list.</p></li>
<li><p><strong>as_dict</strong> – True to get info as a dict.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_feature_list">
<code class="sig-name descname">get_feature_list</code><span class="sig-paren">(</span><em class="sig-param">nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_feature_size">
<code class="sig-name descname">get_feature_size</code><span class="sig-paren">(</span><em class="sig-param">ft_type='gene'</em>, <em class="sig-param">feat_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns feature size as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ft_type</strong> – The feature type (3rd column). Could be gene, transcript, exon, CDS…</p></li>
<li><p><strong>feat_id</strong> – the string used as feature identifier in the GTF. Could be gene_id, transcript_id, exon_id, CDS_id… By default it is computed as ft_type + ‘_id’</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_size</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="s2">&quot;exon_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_ids">
<code class="sig-name descname">get_gn_ids</code><span class="sig-paren">(</span><em class="sig-param">nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all gene ids from the GTF file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001,G0002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_strand">
<code class="sig-name descname">get_gn_strand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene IDs as keys and strands as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0005&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_to_tx">
<code class="sig-name descname">get_gn_to_tx</code><span class="sig-paren">(</span><em class="sig-param">ordered_5p=False</em>, <em class="sig-param">as_dict_of_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with genes as keys and the list of their associated transcripts
as values.</p>
<p>params ordered_5p: If True, returns transcript list ordered based on their TSS coordinates (5’ to 3’). For ties, transcript name are randomly picked.
params as_dict_of_dict: If True, returns a dict of dict that maps gene_id to transcript_id and transcript_id to TSS numbering (1 for most 5’, then 2…). For transcripts having the same TSSs, the tss number will be the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">ordered_5p</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148337&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000372948&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634901&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634501&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000373068&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373069&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373066&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">:]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000472769&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000445012&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000466983&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">as_dict_of_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587658&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587559&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000430256&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000284006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000589786&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000407193&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000401695&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000519690&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000517510&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000520007&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gname_to_tx">
<code class="sig-name descname">get_gname_to_tx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gname_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene names as keys and the list of their associated transcripts
as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_intergenic">
<code class="sig-name descname">get_intergenic</code><span class="sig-paren">(</span><em class="sig-param">chrom_file=None</em>, <em class="sig-param">upstream=0</em>, <em class="sig-param">downstream=0</em>, <em class="sig-param">chr_list=None</em>, <em class="sig-param">feature_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_intergenic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intergenic regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrom_file</strong> – file object pointing to a tabulated two-columns file. Chromosomes as column 1 and their sizes as column 2 (default: None)</p></li>
<li><p><strong>upstream</strong> – Extend transcript coordinates in 5’ direction.</p></li>
<li><p><strong>downstream</strong> – Extend transcript coordinates in 3’ direction.</p></li>
<li><p><strong>chr_list</strong> – a list of chromosome to restrict intergenic regions.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;chromInfo&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">chr_info_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_intergenic</span><span class="p">(</span><span class="n">chrom_file</span><span class="o">=</span><span class="n">chr_info_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_introns">
<code class="sig-name descname">get_introns</code><span class="sig-paren">(</span><em class="sig-param">by_transcript=False</em>, <em class="sig-param">name=('transcript_id'</em>, <em class="sig-param">'gene_id')</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">intron_nb_in_name=False</em>, <em class="sig-param">feat_name=False</em>, <em class="sig-param">feat_name_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_introns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intronic regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>by_transcript</strong> – If false (default), merged genic regions with no exonic overlap are returned. Otherwise, the intronic regions corresponding to each transcript are returned (may contain exonic overlap).</p></li>
<li><p><strong>name</strong> – The list of ids that should be part of the 4th column of the bed file (if by_transcript is chosen).</p></li>
<li><p><strong>sep</strong> – The separator to be used for the name (if by_transcript is chosen).</p></li>
<li><p><strong>intron_nb_in_name</strong> – by default the intron number is added to the score column. If selected, write this information in the ‘name’ column of the bed file.</p></li>
<li><p><strong>feat_name</strong> – add the feature name (‘intron’) in the name column.</p></li>
<li><p><strong>feat_name_last</strong> – put feat_name in last position (but before intron_nb_in_name).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_introns</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_midpoints">
<code class="sig-name descname">get_midpoints</code><span class="sig-paren">(</span><em class="sig-param">name=('transcript_id'</em>, <em class="sig-param">'gene_id')</em>, <em class="sig-param">sep='|'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_midpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the midpoints of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id’)”.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_midpoints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_sequences">
<code class="sig-name descname">get_sequences</code><span class="sig-paren">(</span><em class="sig-param">genome=None</em>, <em class="sig-param">intron=False</em>, <em class="sig-param">rev_comp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_sequences" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a FASTA object from which various sequences can be retrieved.</p>
<dl class="field-list simple">
<dt class="field-odd">param genome</dt>
<dd class="field-odd"><p>The genome in fasta file.</p>
</dd>
<dt class="field-even">param intron</dt>
<dd class="field-even"><p>Set to True to get also intronic regions. Required for some methods of the FASTA object.</p>
</dd>
<dt class="field-odd">param rev_comp</dt>
<dd class="field-odd"><p>By default sequence for genes on minus strand are         reversed-complemented. Set to False to avoid default behaviour.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_fa</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;catgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, no reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;agcgcatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;catatggtgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and no Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;agcgcaccatatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_transcript_size">
<code class="sig-name descname">get_transcript_size</code><span class="sig-paren">(</span><em class="sig-param">with_intron=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript_id as keys and their mature RNA length
(i.e exon only) of each transcript.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>with_intron</strong> – If True, add intronic regions.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">(</span><span class="n">with_intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tss">
<code class="sig-name descname">get_tss</code><span class="sig-paren">(</span><em class="sig-param">name='transcript_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">as_dict=False</em>, <em class="sig-param">more_name=()</em>, <em class="sig-param">one_based=False</em>, <em class="sig-param">feature_name=None</em>, <em class="sig-param">explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tss" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TSSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a tuple).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tts">
<code class="sig-name descname">get_tts</code><span class="sig-paren">(</span><em class="sig-param">name='transcript_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">as_dict=False</em>, <em class="sig-param">more_name=()</em>, <em class="sig-param">feature_name=None</em>, <em class="sig-param">explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TTSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_ids">
<code class="sig-name descname">get_tx_ids</code><span class="sig-paren">(</span><em class="sig-param">nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all transcript_id from the GTF file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001T002,G0001T001,G0003T001&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_strand">
<code class="sig-name descname">get_tx_strand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and strands as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0007T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0009T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_to_gn">
<code class="sig-name descname">get_tx_to_gn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcripts IDs as keys and gene IDs as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_to_gname">
<code class="sig-name descname">get_tx_to_gname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gname" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and gene names as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.head">
<code class="sig-name descname">head</code><span class="sig-paren">(</span><em class="sig-param">nb=6</em>, <em class="sig-param">returned=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb first lines of the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb</strong> – The number of line to display.</p></li>
<li><p><strong>returned</strong> – If True, don’t print but returns the message.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.is_defined">
<code class="sig-name descname">is_defined</code><span class="sig-paren">(</span><em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.is_defined" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a numpy array representation of a GTF attribute indicating, for each line, whether the key is defined
(i.e. exists). In pygtftk, values for undefined keys are ‘?’. So in other words this function tests whether
each value differs from ‘?’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of booleans.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_val</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="n">gn_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_feat</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="p">[</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;gene&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">((</span><span class="o">~</span><span class="n">gn_feat</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">gn_feat</span><span class="o">.</span><span class="n">is_set</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.is_set">
<code class="sig-name descname">is_set</code><span class="sig-paren">(</span><em class="sig-param">key=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.is_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a numpy array representation of a GTF attribute indicating, for each line, whether the key is set
(i.e. is defined with value ‘.’). In pygtftk, values for unset keys are ‘.’. So in other words this function
tests whether each value for the input key are set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of booleans.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.merge_attr">
<code class="sig-name descname">merge_attr</code><span class="sig-paren">(</span><em class="sig-param">feat='*'</em>, <em class="sig-param">keys='gene_id</em>, <em class="sig-param">transcript_id'</em>, <em class="sig-param">new_key='gn_tx_id'</em>, <em class="sig-param">sep='|'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.merge_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a set of source keys (e.g gene_id and transcript_id) into a destination attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target features.</p></li>
<li><p><strong>keys</strong> – The source keys.</p></li>
<li><p><strong>new_key</strong> – The destination key.</p></li>
<li><p><strong>sep</strong> – The separator.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">merge_attr</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;exon,transcript,CDS&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;merge&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G0001|G0001T002&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.message">
<code class="sig-name descname">message</code><span class="sig-paren">(</span><em class="sig-param">msg=''</em>, <em class="sig-param">type='INFO'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.message" title="Permalink to this definition">¶</a></dt>
<dd><p>A processing message whose verbosity is adapted based on pygtftk.utils.VERBOSITY.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygtftk.utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.nb_exons">
<code class="sig-name descname">nb_exons</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nb_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict with transcript as key and number of exon as value.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nb_ex</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb_ex</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0005T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple_04&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nb_ex</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.nrow">
<code class="sig-name descname">nrow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of lines enclosed in the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;CDS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_5p_transcript">
<code class="sig-name descname">select_5p_transcript</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_5p_transcript" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the most 5’ transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_key">
<code class="sig-name descname">select_by_key</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">value=None</em>, <em class="sig-param">invert_match=False</em>, <em class="sig-param">file_with_values=None</em>, <em class="sig-param">no_na=True</em>, <em class="sig-param">col=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based i) on attributes and values 2) on
feature type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use for selection.</p></li>
<li><p><strong>value</strong> – Value for that key/attribute.</p></li>
<li><p><strong>invert_match</strong> – Boolean. Select lines that do not match that key and value.</p></li>
<li><p><strong>file_with_values</strong> – A file containing values (one column).</p></li>
<li><p><strong>col</strong> – The column number (one-based) that contains the values in the file.</p></li>
<li><p><strong>no_na</strong> – If invert_match is True then returns only record for which the value is defined.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_loc">
<code class="sig-name descname">select_by_loc</code><span class="sig-paren">(</span><em class="sig-param">chr_str</em>, <em class="sig-param">start_str</em>, <em class="sig-param">end_str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based on genomic location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chr_str</strong> – A comma-separated list of chromosomes.</p></li>
<li><p><strong>start_str</strong> – A comma-separated list of starts.</p></li>
<li><p><strong>end_str</strong> – A comma-separated list of ends.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_loc</span><span class="p">(</span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span> <span class="s2">&quot;125&quot;</span><span class="p">,</span> <span class="s2">&quot;138&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_max_exon_nb">
<code class="sig-name descname">select_by_max_exon_nb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_max_exon_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>For each gene select the transcript with the highest number of exons. If ties, select the first encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple_04&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_max_exon_nb</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0005T001&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0004T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0006T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_number_of_exons">
<code class="sig-name descname">select_by_number_of_exons</code><span class="sig-paren">(</span><em class="sig-param">min=0</em>, <em class="sig-param">max=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_number_of_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Select transcript from a GTF based on the number of exons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> – Minimum number of exons.</p></li>
<li><p><strong>max</strong> – Maximum number of exons.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_number_of_exons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_positions">
<code class="sig-name descname">select_by_positions</code><span class="sig-paren">(</span><em class="sig-param">pos=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a set of lines by position. Numbering zero-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pos</strong> – </p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CDS&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_regexp">
<code class="sig-name descname">select_by_regexp</code><span class="sig-paren">(</span><em class="sig-param">key=None</em>, <em class="sig-param">regexp=None</em>, <em class="sig-param">invert_match=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_regexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lines for which key value match a regular expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use for selection.</p></li>
<li><p><strong>regexp</strong> – the regular expression</p></li>
<li><p><strong>invert_match</strong> – Select lines are those that do not match.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00[012]+T00[12]$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0002T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0010T001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00\d+$&quot;</span><span class="p">))</span><span class="o">==</span><span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00.*2$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">==</span><span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_transcript_size">
<code class="sig-name descname">select_by_transcript_size</code><span class="sig-paren">(</span><em class="sig-param">min=0</em>, <em class="sig-param">max=1000000000</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Select ‘mature/spliced transcript by size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> – Minimum size for the feature.</p></li>
<li><p><strong>max</strong> – Maximum size for the feature.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_kept</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_transcript_size</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_kept</span><span class="p">)</span> <span class="o">==</span> <span class="mi">45</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_longuest_transcripts">
<code class="sig-name descname">select_longuest_transcripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_longuest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the longuest transcript of each gene.
The “gene” rows are returned in the results. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_shortest_transcripts">
<code class="sig-name descname">select_shortest_transcripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_shortest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the shortest transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.tail">
<code class="sig-name descname">tail</code><span class="sig-paren">(</span><em class="sig-param">nb=6</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb last lines of the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nb</strong> – The number of line to display.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.to_bed">
<code class="sig-name descname">to_bed</code><span class="sig-paren">(</span><em class="sig-param">name='gene_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">add_feature_type=False</em>, <em class="sig-param">more_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.to_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object (Bed6 format).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column (a tuple).</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>add_feature_type</strong> – Add the feature type to the name.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_bo</span><span class="o">.</span><span class="n">field_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">output</em>, <em class="sig-param">add_chr=0</em>, <em class="sig-param">gc_off=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.write" title="Permalink to this definition">¶</a></dt>
<dd><p>write the gtf to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> – A file object where the GTF has to be written.</p></li>
<li><p><strong>add_chr</strong> – whether to add ‘chr’ prefix to seqid before printing.</p></li>
<li><p><strong>gc_off</strong> – If True, shutdown the garbage collector before printing to avoid passing through free_gtf_data which can be time-consuming.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.write_bed">
<code class="sig-name descname">write_bed</code><span class="sig-paren">(</span><em class="sig-param">outputfile=None</em>, <em class="sig-param">name='gene_id'</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">add_chr=0</em>, <em class="sig-param">more_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a GTF file in BED format. This function uses a direct call to the C interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – The outputfilename.</p></li>
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column (a tuple).</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.fasta_interface">
<span id="the-fasta-class"></span><h2>The FASTA class<a class="headerlink" href="#module-pygtftk.fasta_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the FASTA object (may be returned by GTF object methods).</p>
<dl class="class">
<dt id="pygtftk.fasta_interface.FASTA">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.fasta_interface.</code><code class="sig-name descname">FASTA</code><span class="sig-paren">(</span><em class="sig-param">fn</em>, <em class="sig-param">ptr</em>, <em class="sig-param">intron</em>, <em class="sig-param">rev_comp</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a fasta file connection. A end product
from a GTF object.</p>
<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records">
<code class="sig-name descname">transcript_as_bioseq_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over transcript sequences with or without intron depending on arguments provided to GTF.get_sequences(). Returns objects of class Bio.SeqRecord.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">transcript_as_bioseq_records</span><span class="p">():</span> <span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rec</span> <span class="o">=</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">outputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the sequences to a fasta file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputfile</strong> – Output file (file object).</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.tab_interface">
<span id="the-tab-class"></span><h2>The TAB class<a class="headerlink" href="#module-pygtftk.tab_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the TAB object (may be returned by a GTF instance).</p>
<dl class="class">
<dt id="pygtftk.tab_interface.TAB">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.tab_interface.</code><code class="sig-name descname">TAB</code><span class="sig-paren">(</span><em class="sig-param">fn</em>, <em class="sig-param">ptr</em>, <em class="sig-param">dll=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a tabulated matrix. An end product
from a GTF object.</p>
<dl class="method">
<dt id="pygtftk.tab_interface.TAB.as_data_frame">
<code class="sig-name descname">as_data_frame</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the TAB object into a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,start&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_tab</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">()[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.as_simple_list">
<code class="sig-name descname">as_simple_list</code><span class="sig-paren">(</span><em class="sig-param">which_col=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_simple_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the selected column of a TAB object into a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>which_col</strong> – The column number.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)[(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a_tab</span><span class="o">.</span><span class="n">as_simple_list</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.iter_as_list">
<code class="sig-name descname">iter_as_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iter_as_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the TAB object and return a list of self.nb_columns elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,start&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">a_tab</span><span class="o">.</span><span class="n">iter_as_list</span><span class="p">())</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">a_tab</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.iterate_with_header">
<code class="sig-name descname">iterate_with_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iterate_with_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over FieldSets. The first line contains the field names.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">iterate_with_header</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;seqid&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">iterate_with_header</span><span class="p">():</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;CDS_G0010T001&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">outfile=None</em>, <em class="sig-param">sep='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a tab object to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.Line">
<span id="the-line-module"></span><h2>The Line module<a class="headerlink" href="#module-pygtftk.Line" title="Permalink to this headline">¶</a></h2>
<p>This section contains representation of GTF, TAB and FASTA records (i.e, ‘lines’).
When iterating over GTF, TAB or FASTA instances, the following objects will be
returned respectively:</p>
<blockquote>
<div><ul class="simple">
<li><p>Feature</p></li>
<li><p>FieldSet</p></li>
<li><p>FastaSequence</p></li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pygtftk.Line.FastaSequence">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.Line.</code><code class="sig-name descname">FastaSequence</code><span class="sig-paren">(</span><em class="sig-param">ptr=None</em>, <em class="sig-param">alist=None</em>, <em class="sig-param">feat='transcript'</em>, <em class="sig-param">rev_comp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a fasta file line.</p>
<dl class="method">
<dt id="pygtftk.Line.FastaSequence.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a formated fasta sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="s1">&#39;AATACAGAGAT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="s1">&#39;&gt;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.FastaSequence.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">file_out=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FastaSequence to a file or stdout (if file is None).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygtftk.Line.Feature">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.Line.</code><code class="sig-name descname">Feature</code><span class="sig-paren">(</span><em class="sig-param">ptr=None</em>, <em class="sig-param">alist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representation of a genomic feature. Corresponds to a GTF line.</p>
<dl class="method">
<dt id="pygtftk.Line.Feature.add_attr">
<code class="sig-name descname">add_attr</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an attribute to the Feature instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.add_attr_and_write">
<code class="sig-name descname">add_attr_and_write</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em>, <em class="sig-param">outputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr_and_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a key/attribute record and write to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr_and_write</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span>  <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">check_ensembl_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in gtf file format. Typically
to write to a gtf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.format_tab">
<code class="sig-name descname">format_tab</code><span class="sig-paren">(</span><em class="sig-param">attr_list</em>, <em class="sig-param">sep='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format_tab" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in tabulated format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_list</strong> – the attributes names.</p></li>
<li><p><strong>sep</strong> – separator.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">TAB</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;g1t1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">format_tab</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.from_list">
<em class="property">classmethod </em><code class="sig-name descname">from_list</code><span class="sig-paren">(</span><em class="sig-param">a_list</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Feature object from a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Params alist</dt>
<dd class="field-odd"><p>a list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">+=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">d</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">alist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_3p_end">
<code class="sig-name descname">get_3p_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3’ end of the feature. Returns ‘end’ if on ‘+’ strand ‘start’
otherwise (one based).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_5p_end">
<code class="sig-name descname">get_5p_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 5’ end of the feature. Returns ‘start’ if on ‘+’ strand ‘end’
otherwise (one based).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_attr_names">
<code class="sig-name descname">get_attr_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the attribute names from the Feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;transcript_id&#39;</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_names</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;gene_id&#39;</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_names</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_attr_value">
<code class="sig-name descname">get_attr_value</code><span class="sig-paren">(</span><em class="sig-param">attr_name</em>, <em class="sig-param">upon_none='continue'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of a basic or extended attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_name</strong> – Name of the attribute/key.</p></li>
<li><p><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or         ‘set_na’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;g1t1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;chrom&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">,</span> <span class="n">upon_none</span><span class="o">=</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">,</span> <span class="n">upon_none</span><span class="o">=</span><span class="s1">&#39;set_na&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_gn_id">
<code class="sig-name descname">get_gn_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_gn_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘gene_id’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_tx_id">
<code class="sig-name descname">get_tx_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_tx_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘transcript_id’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_tx_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1t1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.set_attr">
<code class="sig-name descname">set_attr</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em>, <em class="sig-param">upon_none='continue'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.set_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an attribute value of the Feature instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key.</p></li>
<li><p><strong>val</strong> – The value.</p></li>
<li><p><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or ‘set_na’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">file_out='-'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Feature to a file or stdout (if file is ‘-‘).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed">
<code class="sig-name descname">write_bed</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">format='bed6'</em>, <em class="sig-param">outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – A string to use as name (Column 4).</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
<li><p><strong>outputfile</strong> – the file object were data should be printed.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed_3p_end">
<code class="sig-name descname">write_bed_3p_end</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">format='bed6'</em>, <em class="sig-param">outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 3p end coordinates of feature in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – The output file name.</p></li>
<li><p><strong>name</strong> – The string to be used as fourth column.</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_3p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;199&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;200&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed_5p_end">
<code class="sig-name descname">write_bed_5p_end</code><span class="sig-paren">(</span><em class="sig-param">name=None</em>, <em class="sig-param">format='bed6'</em>, <em class="sig-param">outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 5p end coordinates of feature in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – the output file.</p></li>
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_5p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;99&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;100&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_gtf_to_bed6">
<code class="sig-name descname">write_gtf_to_bed6</code><span class="sig-paren">(</span><em class="sig-param">name=('transcript_id'</em>, <em class="sig-param">'gene_id')</em>, <em class="sig-param">sep='|'</em>, <em class="sig-param">add_feature_type=False</em>, <em class="sig-param">outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_gtf_to_bed6" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based). Select the
key/values to add as a name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>add_feature_type</strong> – Add the feature type to the name.</p></li>
<li><p><strong>outputfile</strong> – the file object were data should be printed.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_gtf_to_bed6</span><span class="p">(</span><span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1t1|g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygtftk.Line.FieldSet">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.Line.</code><code class="sig-name descname">FieldSet</code><span class="sig-paren">(</span><em class="sig-param">ptr=None</em>, <em class="sig-param">size=None</em>, <em class="sig-param">alist=None</em>, <em class="sig-param">ft_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a set of Fields obtained from a splitted line.</p>
<dl class="method">
<dt id="pygtftk.Line.FieldSet.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><em class="sig-param">separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tabulated string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>separator</strong> – output field separator.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.FieldSet.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">file_out=None</em>, <em class="sig-param">separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FieldSet to a file or stdout (if file is None).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> – output field separator.</p></li>
<li><p><strong>file_out</strong> – output file object.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.stats.intersect.overlap_stats_shuffling">
<span id="the-pygtftk-stats-intersect-overlap-stats-shuffling-module"></span><h2>The pygtftk.stats.intersect.overlap_stats_shuffling module<a class="headerlink" href="#module-pygtftk.stats.intersect.overlap_stats_shuffling" title="Permalink to this headline">¶</a></h2>
<p>This is the main function to compute random shuffles to assess statistical
significance overlap of two sets of genomic regions, provided as BED files.</p>
<dl class="function">
<dt id="pygtftk.stats.intersect.overlap_stats_shuffling.compute_all_intersections_minibatch">
<code class="sig-prename descclassname">pygtftk.stats.intersect.overlap_stats_shuffling.</code><code class="sig-name descname">compute_all_intersections_minibatch</code><span class="sig-paren">(</span><em class="sig-param">Lr1</em>, <em class="sig-param">Li1</em>, <em class="sig-param">Lrs</em>, <em class="sig-param">Lis</em>, <em class="sig-param">all_chrom1</em>, <em class="sig-param">all_chrom2</em>, <em class="sig-param">minibatch_size</em>, <em class="sig-param">use_markov_shuffling</em>, <em class="sig-param">nb_threads</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_shuffling.compute_all_intersections_minibatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Main processing function. Computes a minibatch of shuffles for the given parameters.</p>
<p>This function will be called by the hub function <cite>compute_overlap_stats</cite> to
create a batch of shuffled “fake” BED files.
Lr1,Li1,Lr2,Li2,all_chrom1,all_chrom2 are all outputs from the
bed_Li1to_lists_of_intervals() function calls : those are the lists of region
lengths, inter-region lengths, and chromosomes for each of the two input files.</p>
<p>Lrs and Lis are lists containing [Lr2] and [Li2] if there is only one query set, but can contain more [Lr1, Lr2, Lr3, …] if there is more than one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Lr1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Li1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Lrs</strong> – A list of outputs from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Lis</strong> – A list of outputs from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>all_chrom1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>all_chrom2</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>minibatch_size</strong> – The size of the batchs for shuffling.</p></li>
<li><p><strong>use_markov_shuffling</strong> – Use a classical or a order-2 Markov shuffling.</p></li>
<li><p><strong>nb_threads</strong> – number of threads.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pygtftk.stats.intersect.overlap_stats_shuffling.compute_overlap_stats">
<code class="sig-prename descclassname">pygtftk.stats.intersect.overlap_stats_shuffling.</code><code class="sig-name descname">compute_overlap_stats</code><span class="sig-paren">(</span><em class="sig-param">bedA</em>, <em class="sig-param">bedsB</em>, <em class="sig-param">chrom_len</em>, <em class="sig-param">minibatch_size</em>, <em class="sig-param">minibatch_nb</em>, <em class="sig-param">bed_excl</em>, <em class="sig-param">use_markov_shuffling</em>, <em class="sig-param">nb_threads</em>, <em class="sig-param">ft_type</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_shuffling.compute_overlap_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the hub function to compute overlap statistics through Monte Carlo
shuffling with integration of the inter-region lengths.</p>
<p>The function will generate shuffled BEDs from bedA and bedB independantly,
and compute intersections between those shuffles. As such, it gives an
estimation of the intersections under the null hypothesis (the sets of
regions given in A and B are independant).</p>
<p>Author : Quentin FERRE &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bedA</strong> – The first bed file.</p></li>
<li><p><strong>bedsB</strong> – The second bed file. Can also be a list of bed files for multiple overlaps.</p></li>
<li><p><strong>chrom_len</strong> – the dictionary of chromosome lengths</p></li>
<li><p><strong>minibatch_size</strong> – the size of the minibatch for shuffling.</p></li>
<li><p><strong>minibatch_nb</strong> – The number of minibatchs.</p></li>
<li><p><strong>bed_excl</strong> – The regions to be excluded.</p></li>
<li><p><strong>use_markov_shuffling</strong> – Use a classical or a order-2 Markov shuffling.</p></li>
<li><p><strong>nb_threads</strong> – Number of threads.</p></li>
<li><p><strong>ft_type</strong> – The name of the feature.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pygtftk.stats.intersect.negbin_fit">
<span id="the-pygtftk-stats-intersect-negbin-fit-module"></span><h2>The pygtftk.stats.intersect.negbin_fit module<a class="headerlink" href="#module-pygtftk.stats.intersect.negbin_fit" title="Permalink to this headline">¶</a></h2>
<p>Contains various utility functions relative to the negative binomial distribution.</p>
<dl class="function">
<dt id="pygtftk.stats.intersect.negbin_fit.check_negbin_adjustment">
<code class="sig-prename descclassname">pygtftk.stats.intersect.negbin_fit.</code><code class="sig-name descname">check_negbin_adjustment</code><span class="sig-paren">(</span><em class="sig-param">obs</em>, <em class="sig-param">mean</em>, <em class="sig-param">var</em>, <em class="sig-param">bins_number=16</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.negbin_fit.check_negbin_adjustment" title="Permalink to this definition">¶</a></dt>
<dd><p>Considers a Negative Binomial distribution of given mean and var, and
performs an adjustement test of this distrubution with regards to obs.</p>
<p>Returns the result of a Cramer’s V adjustment test.</p>
<p>A classical Chi-squared test cannot be used, since in a typical use case
sample size will be only 250 (shuffles) and as such expected frequency for
each value will be well under 5. As such, we perform the Chi-Squared test
on an equivalent “histogram” : instead of computing the expected number
of variates exactly equal to, say, 22, we compute how many variates fall in
the 20-30 range.
Target bin number is ajustable, final bin number may vary due to rounding.</p>
<p>Futhermore, the Chi-Squared test can artificially return (H0 false) if n is
too large. Hence, we use Cramer’s V test instead.</p>
<p>The function returns 1 - V, where V is the Cramer’s V test of a crosstab
made by concatenating the observed counts and expected counts vectors.</p>
<p>The V test is here used to determine whether there is an association between
counts distribution and the status as ‘expected’ or ‘observed’.
As per Cramer (1948) a good fit should have a fit quality above 1 - 0.25 = 0.75
because V &gt; 0.25 would mean association in most cases.
Typically, you will observe good association when len(obs) is in the thousands.
When it is in the hundreds only, random chance may result in a okay-ish
association (around 0.8). Conversely, if len(obs) is in the thousands, only
fits above 0.9 should be considered good.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – Observed values.</p></li>
<li><p><strong>mean</strong> – The mean for the negative binomial model.</p></li>
<li><p><strong>var</strong> – The variance for the negative binomial model.</p></li>
<li><p><strong>bins_number</strong> – The number of bins in histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">;</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">var</span><span class="o">-</span><span class="n">mean</span><span class="p">)</span> <span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">mean</span><span class="o">/</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">check_negbin_adjustment</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fit</span> <span class="o">&gt;</span> <span class="mf">0.95</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.stats.intersect.negbin_fit.empirical_p_val">
<code class="sig-prename descclassname">pygtftk.stats.intersect.negbin_fit.</code><code class="sig-name descname">empirical_p_val</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.negbin_fit.empirical_p_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick wrapper : empirical two-sided p value.</p>
<p>Returns the proportion of elements greater than x or smaller than x in the data, whichever proportion is smaller.
This can be used with any dataset, not just a negative-binomial-compliant one.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.stats.intersect.negbin_fit.negbin_pval">
<code class="sig-prename descclassname">pygtftk.stats.intersect.negbin_fit.</code><code class="sig-name descname">negbin_pval</code><span class="sig-paren">(</span><em class="sig-param">k</em>, <em class="sig-param">mean</em>, <em class="sig-param">var</em>, <em class="sig-param">precision=1500</em>, <em class="sig-param">ft_type='Unknown'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.negbin_fit.negbin_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>P-value for a negative binomial distribution of the given moments (mean, var).</p>
<p>This is the two-sided p-value : it will return the minimum of the left-sided
and right-sided p-value</p>
<p>NOTE : To prevent division by zero or negative r, if the mean is higher than
or equal to the variance, set the variance to mean + epsilon and send a warning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – the critical value.</p></li>
<li><p><strong>mean</strong> – The mean for the negative binomial model.</p></li>
<li><p><strong>var</strong> – The variance for the negative binomial model.</p></li>
<li><p><strong>precision</strong> – Floating point precision of mpmath. Should be at least 1000</p></li>
<li><p><strong>ft_type</strong> – The name of the feature to be tested (just for meaningful messages).</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.negbin_fit</span> <span class="k">import</span> <span class="n">negbin_pval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="mi">18400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="mi">630200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">65630</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pval</span> <span class="o">=</span> <span class="n">negbin_pval</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">pval</span> <span class="o">==</span> <span class="mf">1.1999432787236828e-307</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pygtftk.stats.intersect.beta">
<span id="the-pygtftk-stats-intersect-beta-module"></span><h2>The pygtftk.stats.intersect.beta module<a class="headerlink" href="#module-pygtftk.stats.intersect.beta" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pygtftk.stats.intersect.beta.BetaCalculator">
<em class="property">class </em><code class="sig-prename descclassname">pygtftk.stats.intersect.beta.</code><code class="sig-name descname">BetaCalculator</code><span class="sig-paren">(</span><em class="sig-param">precision=1500</em>, <em class="sig-param">use_log=True</em>, <em class="sig-param">itermax=100000</em>, <em class="sig-param">ft_type='Unknown'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.beta.BetaCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing the beta distribution in Python using mpmath.</p>
<p>Using routines from the GNU Scientific Library (<cite>beta_inc.c</cite>):
&lt;Copyright (C) 2007 Brian Gough and Copyright (C) 1996, 1997, 1998, 1999, 2000 Gerard Jungman&gt;</p>
<p>Available under the GNU GPL v3 license.</p>
<dl class="simple">
<dt>Formulas :</dt><dd><p>self.betainc(A, B, p) &lt;–&gt;
mpmath.betainc(A, B, 0, p) &lt;–&gt;
mpmath.quad(lambdat: t**(A-1)*(1-t)**(B-1), [0, p])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.beta</span> <span class="k">import</span> <span class="n">BetaCalculator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mpmath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycalc</span> <span class="o">=</span> <span class="n">BetaCalculator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mpmath</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mycalc</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">res_A</span> <span class="o">==</span> <span class="n">res_B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mpmath</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mycalc</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">res_A</span> <span class="o">==</span> <span class="n">res_B</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="pygtftk.stats.intersect.beta.BetaCalculator.beta">
<code class="sig-name descname">beta</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.beta.BetaCalculator.beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses either mpmath’s gamma or log-gamma function to compute values of the beta function.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.stats.intersect.beta.BetaCalculator.betainc">
<code class="sig-name descname">betainc</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.beta.BetaCalculator.betainc" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-regularized incomplete beta. See betaincreg().</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.stats.intersect.beta.BetaCalculator.betaincreg">
<code class="sig-name descname">betaincreg</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.beta.BetaCalculator.betaincreg" title="Permalink to this definition">¶</a></dt>
<dd><p>betaincreg(a,b,x) evaluates the incomplete beta function (regularized).
It requires a, b &gt; 0 and 0 &lt;= x &lt;= 1.</p>
<p>Code translated from: GNU Scientific Library</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.stats.intersect.beta.BetaCalculator.contfractbeta">
<code class="sig-name descname">contfractbeta</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.beta.BetaCalculator.contfractbeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the continued fraction form of the incomplete Beta function.</p>
<p>Code translated from: GNU Scientific Library</p>
<p>Uses the modified Lentz’s method.</p>
<p>You can see a representation of this form in the Digial Library of
Mathematical functions &lt;<a class="reference external" href="https://dlmf.nist.gov/8.17#SS5.p1">https://dlmf.nist.gov/8.17#SS5.p1</a>&gt;.
The goal of the method is to calculate the successive ‘d’ terms,
separately for odd and even.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.utils">
<span id="the-gtftk-utils-module"></span><h2>The gtftk.utils module<a class="headerlink" href="#module-pygtftk.utils" title="Permalink to this headline">¶</a></h2>
<p>A set of useful functions.</p>
<dl class="exception">
<dt id="pygtftk.utils.GTFtkError">
<em class="property">exception </em><code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">GTFtkError</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.GTFtkError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="exception">
<dt id="pygtftk.utils.GTFtkInteractiveError">
<em class="property">exception </em><code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">GTFtkInteractiveError</code><a class="headerlink" href="#pygtftk.utils.GTFtkInteractiveError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pygtftk.utils.add_prefix_to_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">add_prefix_to_file</code><span class="sig-paren">(</span><em class="sig-param">infile</em>, <em class="sig-param">prefix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.add_prefix_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a file object or path (as string) in which the
base name is prefixed with ‘prefix’. Returns a file object (write mode)
or path depending on input type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> – A file object or path.</p></li>
<li><p><strong>prefix</strong> – the prefix to add.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">add_prefix_to_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;data/simple/bla_simple.gtf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">add_prefix_to_file</span><span class="p">(</span><span class="s1">&#39;data/simple/simple.gtf&#39;</span><span class="p">,</span> <span class="s2">&quot;bla_&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_boolean_exprs">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">check_boolean_exprs</code><span class="sig-paren">(</span><em class="sig-param">exprs=None</em>, <em class="sig-param">operand=()</em>, <em class="sig-param">send_error=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_boolean_exprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a boolean expression is properly formed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> – The string to evaluate.</p></li>
<li><p><strong>operand</strong> – The name of the operands.</p></li>
<li><p><strong>send_error</strong> – Whether to throw an error if expression is malformed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A boolean.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_boolean_exprs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_boolean_exprs</span><span class="p">(</span><span class="s1">&#39;s &gt; 1 and (s &lt; 2 or y &lt; 2.5)&#39;</span><span class="p">,</span> <span class="n">operand</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_file_or_dir_exists">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">check_file_or_dir_exists</code><span class="sig-paren">(</span><em class="sig-param">file_or_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_file_or_dir_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a file/directory or a list of files/directories exist. Raise error if a file is not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_or_dir</strong> – file object or a list of file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_file_or_dir_exists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_r_installed">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">check_r_installed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_installed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check R is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_r_installed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check_r_installed()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_r_packages">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">check_r_packages</code><span class="sig-paren">(</span><em class="sig-param">r_pkg_list=None</em>, <em class="sig-param">no_error=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if R packages are installed. Return False otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>no_error</strong> – don’t raise an error if some packages are not found.</p></li>
<li><p><strong>r_pkg_list</strong> – the list of R packages.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_r_packages</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chomp">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">chomp</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete carriage return and line feed from end of string.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chomp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">NEWLINE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">NEWLINE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chomp</span><span class="p">(</span><span class="s2">&quot;blabla</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chrom_info_as_dict">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">chrom_info_as_dict</code><span class="sig-paren">(</span><em class="sig-param">chrom_info_file</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the format of the chromosome info file and return a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chrom_info_file</strong> – A file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chrom_info_as_dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_as_dict</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;all_chrom&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">900</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chrom_info_to_bed_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">chrom_info_to_bed_file</code><span class="sig-paren">(</span><em class="sig-param">chrom_file</em>, <em class="sig-param">chr_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_to_bed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bed file (file object) from a chrom info file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrom_file</strong> – A file object.</p></li>
<li><p><strong>chr_list</strong> – A list of chromosome to be printed to bed file.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chrom_info_to_bed_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pybedtools</span> <span class="k">import</span>  <span class="n">BedTool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_to_bed_file</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">BedTool</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chrs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">chrs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">chrom</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;chr1&#39;</span> <span class="ow">in</span> <span class="n">chrs</span> <span class="ow">and</span> <span class="s1">&#39;chr2&#39;</span> <span class="ow">in</span> <span class="n">chrs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">starts</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">starts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">ends</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">300</span> <span class="ow">in</span> <span class="n">ends</span> <span class="ow">and</span> <span class="mi">600</span> <span class="ow">in</span> <span class="n">ends</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.close_properly">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">close_properly</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.close_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a set of file if they are not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">close_properly</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.flatten_list">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">flatten_list</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">outlist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten a list of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – a list or list of list.</p></li>
<li><p><strong>outlist</strong> – The output list.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">flatten_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Call it with an empty list (outlist)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># otherwise, element will be added to the existing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># outlist variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">],</span> <span class="n">outlist</span><span class="o">=</span><span class="p">[])</span> <span class="o">==</span>  <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">outlist</span><span class="o">=</span><span class="p">[])</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.flatten_list_recur">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">flatten_list_recur</code><span class="sig-paren">(</span><em class="sig-param">a_list</em>, <em class="sig-param">sep=' '</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>Join a list of list.
:param a_list: a list.
:param sep: the separator.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.get_example_feature">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">get_example_feature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an example Feature (i.e GTF line).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.get_example_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">get_example_file</code><span class="sig-paren">(</span><em class="sig-param">datasetname='simple'</em>, <em class="sig-param">ext='gtf'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to a gtf file example located in pygtftk library path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasetname</strong> – The name of the dataset. One of ‘simple’, ‘mini_real’, ‘simple_02, ‘simple_03’.</p></li>
<li><p><strong>ext</strong> – Extension. For ‘simple’ dataset, can be one of ‘bw’, ‘fa’, ‘fa.fai’, ‘chromInfo’, ‘bt*’, ‘fq’, ‘gtf’ or ‘.*’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gtf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bam&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bam&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bw&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bw&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.head_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">head_file</code><span class="sig-paren">(</span><em class="sig-param">afile=None</em>, <em class="sig-param">nb_line=6</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.head_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the first lines of a file (debug).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>afile</strong> – an input file.</p></li>
<li><p><strong>nb_line</strong> – the number of lines to print.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">head_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#head_file(my_file)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.intervals">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">intervals</code><span class="sig-paren">(</span><em class="sig-param">l</em>, <em class="sig-param">n</em>, <em class="sig-param">silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of tuple that correspond to n ~ equally spaced intervals
between 0 and l. Note that n must be lower than len(l).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>silent</strong> – use a silent mode.</p></li>
<li><p><strong>l</strong> – a range</p></li>
<li><p><strong>n</strong> – number of equally spaced intervals.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_comment">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">is_comment</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Check wether a string is a comment (starts with #…).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_comment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_comment</span><span class="p">(</span><span class="s2">&quot;#bla&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_empty">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">is_empty</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the string empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_empty</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_empty</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_exon">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">is_exon</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_exon" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the string contains ‘exon’ preceded or not by spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_exon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;Exon&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_fasta_header">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">is_fasta_header</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_fasta_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the line is a fasta header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – a character string.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_fasta_header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_fasta_header</span><span class="p">(</span><span class="s2">&quot;&gt;DFTDFTD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.make_outdir_and_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">make_outdir_and_file</code><span class="sig-paren">(</span><em class="sig-param">out_dir=None</em>, <em class="sig-param">alist=None</em>, <em class="sig-param">force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_outdir_and_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create output directory and a set of associated files (alist).
Return a list of file handler (write mode) for the requested files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> – the directory where file will be located.</p></li>
<li><p><strong>alist</strong> – the list of requested file names.</p></li>
<li><p><strong>force</strong> – if true, don’t abort if directory already exists.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_outdir_and_file</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.make_tmp_dir">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">make_tmp_dir</code><span class="sig-paren">(</span><em class="sig-param">prefix='tmp'</em>, <em class="sig-param">store=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_tmp_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be call to create a temporary file as all files
declared in TMP_FILE_LIST will be remove upon command exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – a prefix for the temporary file (all of them will contain ‘pygtftk’).</p></li>
<li><p><strong>store</strong> – declare the temporary file in utils.TMP_FILE_LIST. In pygtftk,     the deletion of these files upon exit is controled through -k.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">make_tmp_dir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_dir</span> <span class="o">=</span> <span class="n">make_tmp_dir</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.make_tmp_file">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">make_tmp_file</code><span class="sig-paren">(</span><em class="sig-param">prefix='tmp'</em>, <em class="sig-param">suffix=''</em>, <em class="sig-param">store=True</em>, <em class="sig-param">dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_tmp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be call to create a temporary file as all files
declared in TMP_FILE_LIST will be remove upon command exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – a prefix for the temporary file (all of them will contain ‘pygtftk’).</p></li>
<li><p><strong>suffix</strong> – a suffix (default to ‘’).</p></li>
<li><p><strong>store</strong> – declare the temporary file in utils.TMP_FILE_LIST. In pygtftk,     the deletion of these files upon exit is controled through -k.</p></li>
<li><p><strong>dir</strong> – a target directory.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;pref&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;suf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.median_comp">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">median_comp</code><span class="sig-paren">(</span><em class="sig-param">alist</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.median_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the median from a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alist</strong> – a list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">median_comp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.message">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">message</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">nl=True</em>, <em class="sig-param">type='INFO'</em>, <em class="sig-param">force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a formated message on STDERR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – the message to be send.</p></li>
<li><p><strong>nl</strong> – if True, add a newline.</p></li>
<li><p><strong>type</strong> – Could be INFO, ERROR, WARNING.</p></li>
<li><p><strong>force</strong> – Force message, whatever the verbosity level.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.mkdir_p">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">mkdir_p</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory silently if already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_file_or_dir_exists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">mkdir_p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mkdir_p</span><span class="p">(</span><span class="s1">&#39;/tmp/test_gtftk_mkdir_p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="s1">&#39;/tmp/test_gtftk_mkdir_p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.nested_dict">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">nested_dict</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">type</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.nested_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>“<a class="reference external" href="http://stackoverflow.com/questions/29348345">http://stackoverflow.com/questions/29348345</a></p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.random_string">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">random_string</code><span class="sig-paren">(</span><em class="sig-param">n</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.random_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random string (alpha numeric) of length n.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.silentremove">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">silentremove</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.silentremove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove silently (without error and warning) a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – a file name (or file object).</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">silentremove</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">silentremove</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.simple_line_count">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">simple_line_count</code><span class="sig-paren">(</span><em class="sig-param">afile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_line_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of lines in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>afile</strong> – A file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.simple_nb_column">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">simple_nb_column</code><span class="sig-paren">(</span><em class="sig-param">afile</em>, <em class="sig-param">separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_nb_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the maximum number of columns in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> – the separator (default ”  “).</p></li>
<li><p><strong>afile</strong> – file name.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.sort_2_lists">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">sort_2_lists</code><span class="sig-paren">(</span><em class="sig-param">list1</em>, <em class="sig-param">list2</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.sort_2_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort list1 in increasing order and list2 occordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list1</strong> – the first list.</p></li>
<li><p><strong>list2</strong> – the second list.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">sort_2_lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">sort_2_lists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.tab_line">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">tab_line</code><span class="sig-paren">(</span><em class="sig-param">token=None</em>, <em class="sig-param">newline=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.tab_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tabulated string from an input list with an optional
newline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> – an input list.</p></li>
<li><p><strong>newline</strong> – if True a newline character is added to the string.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">tab_line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tab_line</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;b&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;c&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.to_alphanum">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">to_alphanum</code><span class="sig-paren">(</span><em class="sig-param">string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.to_alphanum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new string in which non alphanumeric character have been replaced by ‘_’. If non alphanumeric characters
are found at the beginning or end of the string, they are deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – A character string in which non alphanumeric char have to be replaced.</p>
</dd>
</dl>
<p>:Example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">to_alphanum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">to_alphanum</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">tf.bla&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;gtf_bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.to_list">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">to_list</code><span class="sig-paren">(</span><em class="sig-param">obj</em>, <em class="sig-param">split_char=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a None, str, tuple to list. May also split if required.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.write_properly">
<code class="sig-prename descclassname">pygtftk.utils.</code><code class="sig-name descname">write_properly</code><span class="sig-paren">(</span><em class="sig-param">a_string</em>, <em class="sig-param">afile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.write_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a string to a file. If file is None, write string to stdout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a_string</strong> – a character string.</p></li>
<li><p><strong>afile</strong> – a file object.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">write_properly</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Help on Python package (pygtftk)</a><ul>
<li><a class="reference internal" href="#module-pygtftk.gtf_interface">The GTF class</a></li>
<li><a class="reference internal" href="#module-pygtftk.fasta_interface">The FASTA class</a></li>
<li><a class="reference internal" href="#module-pygtftk.tab_interface">The TAB class</a></li>
<li><a class="reference internal" href="#module-pygtftk.Line">The Line module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.overlap_stats_shuffling">The pygtftk.stats.intersect.overlap_stats_shuffling module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.negbin_fit">The pygtftk.stats.intersect.negbin_fit module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.beta">The pygtftk.stats.intersect.beta module</a></li>
<li><a class="reference internal" href="#module-pygtftk.utils">The gtftk.utils module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="miscellaneous.html"
                        title="previous chapter">Commands from section ‘miscellaneous’</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bwig_coverage.html"
                        title="next chapter">The pygtftk.bwig.bw_coverage module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The pygtftk.bwig.bw_coverage module"
             >next</a> |</li>
        <li class="right" >
          <a href="miscellaneous.html" title="Commands from section ‘miscellaneous’"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 1.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, F. Lopez and D. Puthier.
      Last updated on Nov 21, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>