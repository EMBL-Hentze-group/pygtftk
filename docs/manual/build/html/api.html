
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Help on Python package (pygtftk) &#8212; gtftk 0.9.1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The gtftk.bam.bam_coverage_matrix module" href="bwig_coverage.html" />
    <link rel="prev" title="Help on gtftk Unix commands" href="presentation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The gtftk.bam.bam_coverage_matrix module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="presentation.html" title="Help on gtftk Unix commands"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 0.9.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="help-on-python-package-pygtftk">
<h1>Help on Python package (pygtftk)<a class="headerlink" href="#help-on-python-package-pygtftk" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pygtftk.gtf_interface">
<span id="the-gtf-class"></span><h2>The GTF class<a class="headerlink" href="#module-pygtftk.gtf_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of GTF object.</p>
<p>When using gtfk a GTF object methods may return:</p>
<blockquote>
<div><ul class="simple">
<li>a GTF object (a representation of a GTF file).</li>
<li>a TAB object (a representation of a tabulated file).</li>
<li>a FASTA object (a representation of a fasta file).</li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pygtftk.gtf_interface.GTF">
<em class="property">class </em><code class="descclassname">pygtftk.gtf_interface.</code><code class="descname">GTF</code><span class="sig-paren">(</span><em>input_obj=None</em>, <em>check_ensembl_format=True</em>, <em>new_data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface to a GTF file. This object returns a GTF, TAB
or FASTA object.</p>
<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_column">
<code class="descname">add_attr_column</code><span class="sig-paren">(</span><em>input_file=None</em>, <em>new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to each line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_file</strong> – a single column file with nrow(GTF_DATA) lines. File lines should be sorted according to the GTF_DATA object. Lines for which a new key should not be added should contain “?”.</li>
<li><strong>new_key</strong> – name of the novel key.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">NEWLINE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gtf</span><span class="p">)):</span> <span class="n">tmp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">NEWLINE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">add_attr_column</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">]</span> <span class="o">==</span> <span class="nb">range</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_dict">
<code class="descname">add_attr_from_dict</code><span class="sig-paren">(</span><em>feat='*'</em>, <em>key='transcript_id'</em>, <em>a_dict=None</em>, <em>new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The comma separated list of target feature. If None, all the features.</li>
<li><strong>key</strong> – The name of the key used for joining (e.g ‘transcript_id’).</li>
<li><strong>a_dict</strong> – key and values will be used to call add_attr_from_file.</li>
<li><strong>new_key</strong> – A name for the novel key.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_dict</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">a_dict</span><span class="o">=</span><span class="n">a_dict</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;exon_nb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id,exon_nb&quot;</span><span class="p">,</span> <span class="n">as_dict_of_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_file">
<code class="descname">add_attr_from_file</code><span class="sig-paren">(</span><em>feat=None</em>, <em>key='transcript_id'</em>, <em>new_key='new_key'</em>, <em>inputfile=None</em>, <em>has_header=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The comma separated list of target feature. If None, all the features.</li>
<li><strong>key</strong> – The name of the key used for joining (i.e the key corresponding to value provided in the file).</li>
<li><strong>new_key</strong> – A name for the novel key.</li>
<li><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</li>
<li><strong>has_header</strong> – Whether the file to join contains column names.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_list">
<code class="descname">add_attr_from_list</code><span class="sig-paren">(</span><em>feat=None</em>, <em>key='transcript_id'</em>, <em>key_value=[]</em>, <em>new_key='new_key'</em>, <em>new_key_value=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The comma separated list of target feature. If None, all the features.</li>
<li><strong>key</strong> – The name of the key used for joining (e.g ‘transcript_id’).</li>
<li><strong>key_value</strong> – The values for the key (e.g [‘tx_1’, ‘tx_2’,…,’tx_n’])</li>
<li><strong>new_key</strong> – A name for the novel key.</li>
<li><strong>new_key_value</strong> – A name for the novel key (e.g [‘val_tx_1’, ‘val_tx_2’,…,’val_tx_n’]).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;G0001&quot;</span><span class="p">,</span> <span class="s2">&quot;G0002&quot;</span><span class="p">],</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;0.8&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;G0002&quot;</span><span class="p">,</span> <span class="s2">&quot;G0001&quot;</span><span class="p">],</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_value</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="n">key_value</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_value</span><span class="p">))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_from_matrix_file">
<code class="descname">add_attr_from_matrix_file</code><span class="sig-paren">(</span><em>feat=None</em>, <em>key='transcript_id'</em>, <em>inputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_matrix_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF file. Expect a matrix with row names as target keys column names as novel key and each cell as value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The comma separated list of target feature. If None, all the features.</li>
<li><strong>key</strong> – The name of the key used for joining (i.e the key corresponding to value provided in the file).</li>
<li><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join_mat&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_matrix_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S1&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S2&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_attr_to_pos">
<code class="descname">add_attr_to_pos</code><span class="sig-paren">(</span><em>input_file=None</em>, <em>new_key='new_key'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_to_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to specific lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_file</strong> – a two column file. First column contains the position/line. Second, the value to be added for ‘new_key’.</li>
<li><strong>new_key</strong> – name of the novel key.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">NEWLINE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gtf</span><span class="p">)):</span> <span class="n">tmp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">NEWLINE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">add_attr_column</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">]</span> <span class="o">==</span> <span class="nb">range</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_exon_number">
<code class="descname">add_exon_number</code><span class="sig-paren">(</span><em>key='exon_nbr'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_exon_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Add exon number to exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> – The key name to use for exon number.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_exon_number</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0003T001&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.add_prefix">
<code class="descname">add_prefix</code><span class="sig-paren">(</span><em>feat='*'</em>, <em>key=None</em>, <em>txt=None</em>, <em>suffix=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a prefix to an attribute value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The target features (default to all).</li>
<li><strong>key</strong> – The target key.</li>
<li><strong>txt</strong> – The string to be added as a prefix.</li>
<li><strong>suffix</strong> – If True append txt string as a suffix.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.convert_to_ensembl">
<code class="descname">convert_to_ensembl</code><span class="sig-paren">(</span><em>check_gene_chr=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.convert_to_ensembl" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a GTF file to ensembl format. This method will add gene
and transcript features if not encountered in the GTF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>check_gene_chr</strong> – By default the function raise an error if several chromosomes are associated with the same gene_id.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene,transcript&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">convert_to_ensembl</span><span class="p">())</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.del_attr">
<code class="descname">del_attr</code><span class="sig-paren">(</span><em>feat='*'</em>, <em>keys=None</em>, <em>force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.del_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an attributes from the GTF file..</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The target feature.</li>
<li><strong>keys</strong> – Comma separated list or list of target keys.</li>
<li><strong>force</strong> – If True, transcript_id and gene_id can be deleted.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,exon_id,ccds_id&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.extract_data">
<code class="descname">extract_data</code><span class="sig-paren">(</span><em>keys=None</em>, <em>as_list=False</em>, <em>zero_based=False</em>, <em>no_na=False</em>, <em>as_dict_of_values=False</em>, <em>as_dict_of_lists=False</em>, <em>as_dict=False</em>, <em>as_dict_of_merged_list=False</em>, <em>nr=False</em>, <em>hide_undef=False</em>, <em>as_list_of_list=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attribute values into containers of various types. Note that in case dict are requested, key are force to no_na.</p>
<p>Note: no_na, hide_undef, nr, zero_based are not applied in case a tab object is returned (default).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keys</strong> – The name of the basic or extended attributes.</li>
<li><strong>as_list</strong> – if true returns values for the first requested key as a list.</li>
<li><strong>no_na</strong> – Discard ‘.’ (i.e undefined value).</li>
<li><strong>as_dict</strong> – if true returns a dict (where the key corresponds to values for the first requested key and values are set to 1). Note that ‘.’ won’t be set as a key (no need to use no_na).</li>
<li><strong>as_dict_of_values</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to value encountered for the second requested key).</li>
<li><strong>as_dict_of_lists</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the last encountered list of other elements).</li>
<li><strong>as_dict_of_merged_list</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the list of other elements encountered throughout any line).</li>
<li><strong>as_list_of_list</strong> – if True returns a list for each line.</li>
<li><strong>nr</strong> – in case a as_list or as_list_of_list is choosen, return a non redondant list.</li>
<li><strong>hide_undef</strong> – if hide_undef, then records for which the key does not exists (value = “?”) are set to are discarded.</li>
<li><strong>zero_based</strong> – If set to True, the start position will be start-1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_tab</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_tab</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.extract_data_iter_list">
<code class="descname">extract_data_iter_list</code><span class="sig-paren">(</span><em>keys=None</em>, <em>zero_based=False</em>, <em>nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data_iter_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attributes of any type and returns an iterator of lists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keys</strong> – The name of the basic or extended attributes.</li>
<li><strong>zero_based</strong> – If set to True, the start position will be start-1.</li>
<li><strong>nr</strong> – if True, return a list with non redundant items.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;125&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">zero_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;124&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">26</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_3p_end">
<code class="descname">get_3p_end</code><span class="sig-paren">(</span><em>feat_type='transcript', name=['transcript_id'], sep='|', as_dict=False, more_name=[], feature_name=None, explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 3’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat_type</strong> – The feature type.</li>
<li><strong>name</strong> – The key that should be used to computed the ‘name’ column.</li>
<li><strong>more_name</strong> – Additional text to add to the name (a list).</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>as_dict</strong> – return the result as a dictionnary.</li>
<li><strong>feature_name</strong> – A feature name to be added to the 4th column.</li>
<li><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_id=G0001|exon_id=G0001T002E001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_5p_end">
<code class="descname">get_5p_end</code><span class="sig-paren">(</span><em>feat_type='transcript', name=['transcript_id'], sep='|', as_dict=False, more_name=[], one_based=False, feature_name=None, explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 5’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat_type</strong> – The feature type.</li>
<li><strong>name</strong> – The key that should be used to computed the ‘name’ column.</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>more_name</strong> – Additional text to add to the name (a list).</li>
<li><strong>as_dict</strong> – return the result as a dictionnary.</li>
<li><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</li>
<li><strong>feature_name</strong> – A feature name to be added to the 4th column.</li>
<li><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;transcript_id=G0001T002|gene_id=G0001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_attr_list">
<code class="descname">get_attr_list</code><span class="sig-paren">(</span><em>add_basic=False</em>, <em>as_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible attributes from a GTF file..</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>add_basic</strong> – add basic attributes to the list. Won’t work if as_dict is True.</li>
<li><strong>as_dict</strong> – If True, returns a dict with the attribute names as key and number of occurence as values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()])</span> <span class="o">==</span> <span class="s1">&#39;gtec&#39;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_attr_value_list">
<code class="descname">get_attr_value_list</code><span class="sig-paren">(</span><em>key=None</em>, <em>count=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_value_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible values taken by an attributes from a GTF file..</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – The key/attribute name to use.</li>
<li><strong>count</strong> – whether the number of occurences should be also returned (returns a list of list).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0010T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_chroms">
<code class="descname">get_chroms</code><span class="sig-paren">(</span><em>nr=False</em>, <em>as_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_chroms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chomosome/sequence ID from the GTF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nr</strong> – True to get a non redondant list.</li>
<li><strong>as_dict</strong> – True to get info as a dict.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_feature_list">
<code class="descname">get_feature_list</code><span class="sig-paren">(</span><em>nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nr</strong> – True to get a non redondant list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_feature_size">
<code class="descname">get_feature_size</code><span class="sig-paren">(</span><em>ft_type='gene'</em>, <em>feat_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns feature size as a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ft_type</strong> – The feature type (3rd column). Could be gene, transcript, exon, CDS…</li>
<li><strong>feat_id</strong> – the string used as feature identifier in the GTF. Could be gene_id, transcript_id, exon_id, CDS_id… By default it is computed as ft_type + ‘_id’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_size</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="s2">&quot;exon_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_ids">
<code class="descname">get_gn_ids</code><span class="sig-paren">(</span><em>nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all gene ids from the GTF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nr</strong> – True to get a non redondant list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001,G0002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_strand">
<code class="descname">get_gn_strand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene IDs as keys and strands as values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0005&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gn_to_tx">
<code class="descname">get_gn_to_tx</code><span class="sig-paren">(</span><em>ordered_5p=False</em>, <em>as_dict_of_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with genes as keys and the list of their associated transcripts
as values.</p>
<p>params ordered_5p: If True, returns transcript list ordered based on their TSS coordinates (5’ to 3’). For ties, value are randomly picked.
params as_dict_of_dict: If True, returns a dict of dict that maps gene_id to transcript_id and transcript_id to TSS numbering (1 for most 5’, then 2…).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">ordered_5p</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148337&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000372948&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634901&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634501&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000373068&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373069&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373066&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">:]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000472769&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000445012&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000466983&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">as_dict_of_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587658&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587559&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000430256&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000284006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000589786&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000407193&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000401695&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000519690&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000517510&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000520007&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_gname_to_tx">
<code class="descname">get_gname_to_tx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gname_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene names as keys and the list of their associated transcripts
as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_intergenic">
<code class="descname">get_intergenic</code><span class="sig-paren">(</span><em>chrom_file=None</em>, <em>upstream=0</em>, <em>downstream=0</em>, <em>chr_list=None</em>, <em>feature_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_intergenic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intergenic regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chrom_file</strong> – file object pointing to a tabulated two-columns file. Chromosomes as column 1 and their sizes as column 2 (default: None)</li>
<li><strong>upstream</strong> – Extend transcript coordinates in 5’ direction.</li>
<li><strong>downstream</strong> – Extend transcript coordinates in 3’ direction.</li>
<li><strong>chr_list</strong> – a list of chromosome to restrict intergenic regions.</li>
<li><strong>feature_name</strong> – A feature name to be added to the 4th column.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;chromInfo&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">chr_info_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_intergenic</span><span class="p">(</span><span class="n">chrom_file</span><span class="o">=</span><span class="n">chr_info_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_introns">
<code class="descname">get_introns</code><span class="sig-paren">(</span><em>by_transcript=False, name=['transcript_id', 'gene_id'], sep='|', intron_nb_in_name=False, feat_name=False, feat_name_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_introns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intronic regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>by_transcript</strong> – If false (default), merged genic regions with no exonic overlap are returned. Otherwise, the intronic regions corresponding to each transcript are returned (may contain exonic overlap).</li>
<li><strong>name</strong> – The list of ids that should be part of the 4th column of the bed file (if by_transcript is choosen).</li>
<li><strong>sep</strong> – The separator to be used for the name (if by_transcript is choosen).</li>
<li><strong>intron_nb_in_name</strong> – by default the intron number is added to the score column. If selected, write this information in the ‘name’ column of the bed file.</li>
<li><strong>feat_name</strong> – add the feature name (‘intron’) in the name column.</li>
<li><strong>feat_name_last</strong> – put feat_name in last position (but before intron_nb_in_name).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_introns</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_midpoints">
<code class="descname">get_midpoints</code><span class="sig-paren">(</span><em>name=['transcript_id', 'gene_id'], sep='|'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_midpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the midpoints of features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The key that should be used to computed the ‘name’ column.</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id’)”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_midpoints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_sequences">
<code class="descname">get_sequences</code><span class="sig-paren">(</span><em>genome=None</em>, <em>intron=False</em>, <em>rev_comp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_sequences" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a FASTA object from which various sequences can be retrieved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param genome:</th><td class="field-body">The genome in fasta file.</td>
</tr>
<tr class="field-even field"><th class="field-name">param intron:</th><td class="field-body">Set to True to get also intronic regions. Required for some methods of the FASTA object.</td>
</tr>
<tr class="field-odd field"><th class="field-name">param rev_comp:</th><td class="field-body">By default sequence for genes on minus strand are         reversed-complemented. Set to False to avoid default behaviour.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_fa</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;catgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, no reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;agcgcatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;catatggtgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and no Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;agcgcaccatatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_transcript_size">
<code class="descname">get_transcript_size</code><span class="sig-paren">(</span><em>with_intron=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript_id as keys and their mature RNA length
(i.e exon only) of each transcript.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>with_intron</strong> – If True, add intronic regions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">(</span><span class="n">with_intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tss">
<code class="descname">get_tss</code><span class="sig-paren">(</span><em>name=['transcript_id'], sep='|', as_dict=False, more_name=[], one_based=False, feature_name=None, explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tss" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TSSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The key that should be used to computed the ‘name’ column.</li>
<li><strong>more_name</strong> – Additional text to add to the name (a list).</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>as_dict</strong> – return the result as a dictionnary.</li>
<li><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</li>
<li><strong>feature_name</strong> – A feature name to be added to the 4th column.</li>
<li><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tts">
<code class="descname">get_tts</code><span class="sig-paren">(</span><em>name=['transcript_id'], sep='|', as_dict=False, more_name=[], feature_name=None, explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TTSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The key that should be used to computed the ‘name’ column.</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>as_dict</strong> – return the result as a dictionnary.</li>
<li><strong>more_name</strong> – Additional text to add to the name (a list).</li>
<li><strong>feature_name</strong> – A feature name to be added to the 4th column.</li>
<li><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_ids">
<code class="descname">get_tx_ids</code><span class="sig-paren">(</span><em>nr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all transcript_id from the GTF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nr</strong> – True to get a non redondant list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001T002,G0001T001,G0003T001&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_strand">
<code class="descname">get_tx_strand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and strands as values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0007T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0009T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_to_gn">
<code class="descname">get_tx_to_gn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcripts IDs as keys and gene IDs as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.get_tx_to_gname">
<code class="descname">get_tx_to_gname</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gname" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and gene names as values.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.head">
<code class="descname">head</code><span class="sig-paren">(</span><em>nb=6</em>, <em>returned=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb first lines of the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> – The number of line to display.</li>
<li><strong>returned</strong> – If True, don’t print but returns the message.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.merge_attr">
<code class="descname">merge_attr</code><span class="sig-paren">(</span><em>feat='*'</em>, <em>keys='gene_id</em>, <em>transcript_id'</em>, <em>new_key='gn_tx_id'</em>, <em>sep='|'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.merge_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a set of source keys (e.g gene_id and transcript_id) into a destination attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>feat</strong> – The target features.</li>
<li><strong>keys</strong> – The source keys.</li>
<li><strong>new_key</strong> – The destination key.</li>
<li><strong>sep</strong> – The separator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">merge_attr</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;exon,transcript,CDS&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;merge&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G0001|G0001T002&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.nb_exons">
<code class="descname">nb_exons</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nb_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict with transcript as key and number of exon as value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G0003T001&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G0010T001&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.nrow">
<code class="descname">nrow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of lines enclosed in the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;CDS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_5p_transcript">
<code class="descname">select_5p_transcript</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_5p_transcript" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the most 5’ transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_key">
<code class="descname">select_by_key</code><span class="sig-paren">(</span><em>key=None</em>, <em>value=None</em>, <em>invert_match=False</em>, <em>file_with_values=None</em>, <em>no_na=True</em>, <em>col=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based i) on attributes and values 2) on
feature type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – The key/attribute name to use for selection.</li>
<li><strong>value</strong> – Value for that key/attribute.</li>
<li><strong>invert_match</strong> – Boolean. Select lines that do not match that key and value.</li>
<li><strong>file_with_values</strong> – A file containing values (one column).</li>
<li><strong>col</strong> – The column number (one-based) that contains the values in the file.</li>
<li><strong>no_na</strong> – If invert_match is True then returns only record for which the value is defined.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_loc">
<code class="descname">select_by_loc</code><span class="sig-paren">(</span><em>chr_str</em>, <em>start_str</em>, <em>end_str</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based on genomic location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chr_str</strong> – A comma separated list of chromosomes.</li>
<li><strong>start_str</strong> – A comma separated list of starts.</li>
<li><strong>end_str</strong> – A comma separated list of ends.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_loc</span><span class="p">(</span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span> <span class="s2">&quot;125&quot;</span><span class="p">,</span> <span class="s2">&quot;138&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_max_exon_nb">
<code class="descname">select_by_max_exon_nb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_max_exon_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>For each gene select the transcript with the highest number of exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple_04&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_max_exon_nb</span><span class="p">()</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0005T001&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0004T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0006T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_number_of_exons">
<code class="descname">select_by_number_of_exons</code><span class="sig-paren">(</span><em>min=0</em>, <em>max=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_number_of_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Select transcript from a GTF based on the number of exons.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>min</strong> – Minimum number of exons.</li>
<li><strong>max</strong> – Maximum number of exons.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_number_of_exons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_numeric_value">
<code class="descname">select_by_numeric_value</code><span class="sig-paren">(</span><em>bool_exp=None, na_omit=['.', '?']</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_numeric_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Test a numeric value. Select lines using a boolean operation on attributes.
The boolean expression must contain attributes enclosed with braces.
Example: “cDNA_length &gt; 200 and tx_genomic_length &gt; 2000”.
Note that one can refers to the name of the first columns of the gtf using e.g:
start, end, score or frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bool_exp</strong> – A simple boolean operation. And/or operation are not supported at the moment.</li>
<li><strong>na_omit</strong> – Any line for which one of the tested value is in this list wont be evaluated (e.g. [“.”, “?”]).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;G0001T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0002T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0003T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0004T001&quot;</span><span class="p">],</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;10&quot;</span><span class="p">,</span><span class="s2">&quot;11&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;test &gt; 2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s1">&#39;feature&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;score == 0&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;start == 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;start != 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;54801291&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;end == 54801291&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and start == 53802771&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and (start == 53802771 or start == 53806156)&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_numeric_value</span><span class="p">(</span><span class="s2">&quot;phase &gt; 0 and phase &lt; 2&quot;</span><span class="p">,</span> <span class="n">na_omit</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_positions">
<code class="descname">select_by_positions</code><span class="sig-paren">(</span><em>pos=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a set of lines by position. Numbering zero-based.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CDS&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_regexp">
<code class="descname">select_by_regexp</code><span class="sig-paren">(</span><em>key=None</em>, <em>regexp=None</em>, <em>invert_match=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_regexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lines for which key value match a regular expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – The key/attribute name to use for selection.</li>
<li><strong>regexp</strong> – the regular expression</li>
<li><strong>invert_match</strong> – Select lines are those that do not match.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00[012]+T00[12]$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0002T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0010T001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00\d+$&quot;</span><span class="p">))</span><span class="o">==</span><span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00.*2$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">==</span><span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_by_transcript_size">
<code class="descname">select_by_transcript_size</code><span class="sig-paren">(</span><em>min=0</em>, <em>max=1000000000</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Select ‘mature/spliced transcript by size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>min</strong> – Minimum size for the feature.</li>
<li><strong>max</strong> – Maximum size for the feature.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_kept</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_transcript_size</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_kept</span><span class="p">)</span> <span class="o">==</span> <span class="mi">45</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_longuest_transcripts">
<code class="descname">select_longuest_transcripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_longuest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the longuest transcript of each gene.
The “gene” rows are returned in the results. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.select_shortest_transcripts">
<code class="descname">select_shortest_transcripts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_shortest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the shortest transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.tail">
<code class="descname">tail</code><span class="sig-paren">(</span><em>nb=6</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb last lines of the GTF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> – The number of line to display.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.to_bed">
<code class="descname">to_bed</code><span class="sig-paren">(</span><em>name=['gene_id'], sep='|', add_feature_type=False, more_name=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.to_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object (Bed6 format).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</li>
<li><strong>more_name</strong> – Additional text to add to the name (a list).</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>add_feature_type</strong> – Add the feature type to the name.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_bo</span><span class="o">.</span><span class="n">field_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.gtf_interface.GTF.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>output</em>, <em>add_chr=0</em>, <em>gc_off=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.write" title="Permalink to this definition">¶</a></dt>
<dd><p>write the gtf to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>output</strong> – A file object where the GTF has to be written.</li>
<li><strong>add_chr</strong> – whether to add ‘chr’ prefix to seqid before printing.</li>
<li><strong>gc_off</strong> – If True, shutdown the garbage collector before printing to avoid passing through free_gtf_data which can be time-consuming.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.fasta_interface">
<span id="the-fasta-class"></span><h2>The FASTA class<a class="headerlink" href="#module-pygtftk.fasta_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the FASTA object (may be returned by GTF object methods).</p>
<dl class="class">
<dt id="pygtftk.fasta_interface.FASTA">
<em class="property">class </em><code class="descclassname">pygtftk.fasta_interface.</code><code class="descname">FASTA</code><span class="sig-paren">(</span><em>fn</em>, <em>ptr</em>, <em>intron</em>, <em>rev_comp</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a fasta file connection. A end product
from a GTF object.</p>
<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><em>feat='exon'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate feature wise</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>feat</strong> – The feature type (exon, CDS).</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001T002&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0003&#39;</span><span class="p">,</span> <span class="s1">&#39;G0003T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;gcttg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0003&#39;</span><span class="p">,</span> <span class="s1">&#39;G0003T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;aatta&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0004&#39;</span><span class="p">,</span> <span class="s1">&#39;G0004T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0004&#39;</span><span class="p">,</span> <span class="s1">&#39;G0004T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;atct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;CDS&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001T002&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;cccccg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0003&#39;</span><span class="p">,</span> <span class="s1">&#39;G0003T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;ttg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0004&#39;</span><span class="p">,</span> <span class="s1">&#39;G0004T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;atc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0004&#39;</span><span class="p">,</span> <span class="s1">&#39;G0004T002&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0004&#39;</span><span class="p">,</span> <span class="s1">&#39;G0004T002&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;gc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0006&#39;</span><span class="p">,</span> <span class="s1">&#39;G0006T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="s1">&#39;acat&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[(</span><span class="s1">&#39;G0006&#39;</span><span class="p">,</span> <span class="s1">&#39;G0006T001&#39;</span><span class="p">,</span> <span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;CDS&#39;</span><span class="p">)]</span>  <span class="o">==</span> <span class="s1">&#39;att&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.enumerate">
<code class="descname">enumerate</code><span class="sig-paren">(</span><em>type='any'</em>, <em>add_feature=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.enumerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate transcript wise and return tx_id and a list of exons</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.iter_features">
<code class="descname">iter_features</code><span class="sig-paren">(</span><em>feat='exon'</em>, <em>no_feat_name=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.iter_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>feat</strong> – The feature type (exon, CDS).</li>
<li><strong>no_feat_name</strong> – Don’t write the feature type in the header.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get exons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">iter_features</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">):</span> <span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">rec</span><span class="o">.</span><span class="n">sequence</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">a_list</span> <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">transcript_id</span> <span class="o">==</span> <span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;gcgct&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">rec</span><span class="o">.</span><span class="n">sequence</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">a_list</span> <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">transcript_id</span> <span class="o">==</span> <span class="s1">&#39;G0004T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;atct&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;gcg&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get exons not reverse-complemented</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">iter_features</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">):</span> <span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">rec</span><span class="o">.</span><span class="n">sequence</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">a_list</span> <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">transcript_id</span> <span class="o">==</span> <span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;agcgc&#39;</span><span class="p">,</span> <span class="s1">&#39;atg&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">rec</span><span class="o">.</span><span class="n">sequence</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">a_list</span> <span class="k">if</span> <span class="n">rec</span><span class="o">.</span><span class="n">transcript_id</span> <span class="o">==</span> <span class="s1">&#39;G0004T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;atct&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;gcg&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records">
<code class="descname">transcript_as_bioseq_records</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over transcript sequences with or without intron depending on arguments provided to GTF.get_sequences(). Returns objects of class Bio.SeqRecord.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">transcript_as_bioseq_records</span><span class="p">():</span> <span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rec</span> <span class="o">=</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.fasta_interface.FASTA.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>outputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the sequences to a fasta file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outputfile</strong> – Output file (file object).</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.tab_interface">
<span id="the-tab-class"></span><h2>The TAB class<a class="headerlink" href="#module-pygtftk.tab_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the TAB object (may be returned by a GTF instance).</p>
<dl class="class">
<dt id="pygtftk.tab_interface.TAB">
<em class="property">class </em><code class="descclassname">pygtftk.tab_interface.</code><code class="descname">TAB</code><span class="sig-paren">(</span><em>fn</em>, <em>ptr</em>, <em>dll=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a tabulated matrix. An end product
from a GTF object.</p>
<dl class="method">
<dt id="pygtftk.tab_interface.TAB.as_data_frame">
<code class="descname">as_data_frame</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the TAB object into a dataframe.</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.as_simple_list">
<code class="descname">as_simple_list</code><span class="sig-paren">(</span><em>which_col=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_simple_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the selected column of a TAB object into a list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>which_col</strong> – The column number.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)[(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a_tab</span><span class="o">.</span><span class="n">as_simple_list</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.iter_as_list">
<code class="descname">iter_as_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iter_as_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the TAB object and return a list of self.nb_columns elements..</p>
</dd></dl>

<dl class="method">
<dt id="pygtftk.tab_interface.TAB.iterate_with_header">
<code class="descname">iterate_with_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iterate_with_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over FieldSets. The first line contains the field names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">iterate_with_header</span><span class="p">()</span><span class="o">.</span><span class="n">next</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;seqid&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.Line">
<span id="the-line-module"></span><h2>The Line module<a class="headerlink" href="#module-pygtftk.Line" title="Permalink to this headline">¶</a></h2>
<p>This section contains representation of GTF, TAB and FASTA records (i.e, ‘lines’).
When iterating over GTF, TAB or FASTA instances, the following objects will be
returned respectively:</p>
<blockquote>
<div><ul class="simple">
<li>Feature</li>
<li>FieldSet</li>
<li>FastaSequence</li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pygtftk.Line.FastaSequence">
<em class="property">class </em><code class="descclassname">pygtftk.Line.</code><code class="descname">FastaSequence</code><span class="sig-paren">(</span><em>ptr=None</em>, <em>alist=None</em>, <em>feat='transcript'</em>, <em>rev_comp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a fasta file line.</p>
<dl class="method">
<dt id="pygtftk.Line.FastaSequence.format">
<code class="descname">format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a formated fasta sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="s1">&#39;AATACAGAGAT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="s1">&#39;&gt;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.FastaSequence.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>file_out=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FastaSequence to a file or stdout (if file is None).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygtftk.Line.Feature">
<em class="property">class </em><code class="descclassname">pygtftk.Line.</code><code class="descname">Feature</code><span class="sig-paren">(</span><em>ptr=None</em>, <em>alist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representation of a genomic feature. Corresponds to a GTF line.</p>
<dl class="method">
<dt id="pygtftk.Line.Feature.add_attr">
<code class="descname">add_attr</code><span class="sig-paren">(</span><em>key</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an attribute to the Feature instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.add_attr_and_write">
<code class="descname">add_attr_and_write</code><span class="sig-paren">(</span><em>key</em>, <em>val</em>, <em>outputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr_and_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a key/attribute record and write to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr_and_write</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="k">import</span>  <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">check_ensembl_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.format">
<code class="descname">format</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in gtf file format. Typically
to write to a gtf file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.format_tab">
<code class="descname">format_tab</code><span class="sig-paren">(</span><em>attr_list</em>, <em>sep='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format_tab" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in tabulated format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attr_list</strong> – the attributes names.</li>
<li><strong>sep</strong> – separator.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;chr1</span><span class="se">\t</span><span class="s1">Unknown</span><span class="se">\t</span><span class="s1">transcript</span><span class="se">\t</span><span class="s1">100</span><span class="se">\t</span><span class="s1">200</span><span class="se">\t</span><span class="s1">.</span><span class="se">\t</span><span class="s1">+</span><span class="se">\t</span><span class="s1">.</span><span class="se">\t</span><span class="s1">g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">format_tab</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="pygtftk.Line.Feature.from_list">
<em class="property">classmethod </em><code class="descname">from_list</code><span class="sig-paren">(</span><em>a_list</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Feature object from a list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Params alist:</th><td class="field-body">a list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">+=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">d</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">alist</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_3p_end">
<code class="descname">get_3p_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3’ end of the feature. Returns ‘end’ if on ‘+’ strand ‘start’
otherwise (one based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_5p_end">
<code class="descname">get_5p_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 5’ end of the feature. Returns ‘start’ if on ‘+’ strand ‘end’
otherwise (one based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_attr_names">
<code class="descname">get_attr_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the attribute names from the Feature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_names</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;gene_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_attr_value">
<code class="descname">get_attr_value</code><span class="sig-paren">(</span><em>attr_name</em>, <em>upon_none='continue'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of a basic or extended attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attr_name</strong> – Name of the attribute/key.</li>
<li><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or         ‘set_na’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;g1t1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;chrom&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">,</span> <span class="n">upon_none</span><span class="o">=</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_gn_id">
<code class="descname">get_gn_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_gn_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘gene_id’ attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.get_tx_id">
<code class="descname">get_tx_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_tx_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘transcript_id’ attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_tx_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1t1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.set_attr">
<code class="descname">set_attr</code><span class="sig-paren">(</span><em>key</em>, <em>val</em>, <em>upon_none='continue'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.set_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an attribute value of the Feature instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> – The key.</li>
<li><strong>val</strong> – The value.</li>
<li><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or ‘set_na’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>file_out='-'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Feature to a file or stdout (if file is ‘-‘).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed">
<code class="descname">write_bed</code><span class="sig-paren">(</span><em>name=None</em>, <em>format='bed6'</em>, <em>outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – A string to use as name (Column 4).</li>
<li><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</li>
<li><strong>outputfile</strong> – the file object were data should be printed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed_3p_end">
<code class="descname">write_bed_3p_end</code><span class="sig-paren">(</span><em>name=None</em>, <em>format='bed6'</em>, <em>outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 3p end coordinates of feature in bed format (Zero-based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>outputfile</strong> – The output file name.</li>
<li><strong>name</strong> – The string to be used as fourth column.</li>
<li><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_3p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;199&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;200&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_bed_5p_end">
<code class="descname">write_bed_5p_end</code><span class="sig-paren">(</span><em>name=None</em>, <em>format='bed6'</em>, <em>outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 5p end coordinates of feature in bed format (Zero-based).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>outputfile</strong> – the output file.</li>
<li><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</li>
<li><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_5p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;99&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;100&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.Feature.write_gtf_to_bed6">
<code class="descname">write_gtf_to_bed6</code><span class="sig-paren">(</span><em>name=['transcript_id', 'gene_id'], sep='|', add_feature_type=False, outputfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_gtf_to_bed6" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based). Select the
key/values to add as a name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</li>
<li><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</li>
<li><strong>add_feature_type</strong> – Add the feature type to the name.</li>
<li><strong>outputfile</strong> – the file object were data should be printed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_gtf_to_bed6</span><span class="p">(</span><span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1t1|g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pygtftk.Line.FieldSet">
<em class="property">class </em><code class="descclassname">pygtftk.Line.</code><code class="descname">FieldSet</code><span class="sig-paren">(</span><em>ptr=None</em>, <em>size=None</em>, <em>alist=None</em>, <em>ft_type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a set of Fields obtained from a splitted line.</p>
<dl class="method">
<dt id="pygtftk.Line.FieldSet.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tabulated string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>separator</strong> – output field separator.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pygtftk.Line.FieldSet.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>file_out=None</em>, <em>separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FieldSet to a file or stdout (if file is None).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>separator</strong> – output field separator.</li>
<li><strong>file_out</strong> – output file object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="k">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygtftk.utils">
<span id="the-gtftk-utils-module"></span><h2>The gtftk.utils module<a class="headerlink" href="#module-pygtftk.utils" title="Permalink to this headline">¶</a></h2>
<p>A set of useful functions.</p>
<dl class="exception">
<dt id="pygtftk.utils.GTFtkError">
<em class="property">exception </em><code class="descclassname">pygtftk.utils.</code><code class="descname">GTFtkError</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.GTFtkError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="exception">
<dt id="pygtftk.utils.GTFtkInteractiveError">
<em class="property">exception </em><code class="descclassname">pygtftk.utils.</code><code class="descname">GTFtkInteractiveError</code><a class="headerlink" href="#pygtftk.utils.GTFtkInteractiveError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pygtftk.utils.add_prefix_to_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">add_prefix_to_file</code><span class="sig-paren">(</span><em>infile</em>, <em>prefix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.add_prefix_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a file object or path (as string) in which the
base name is prefixed with ‘prefix’. Returns a file object (write mode)
or path depending on input type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>infile</strong> – A file object or path.</li>
<li><strong>prefix</strong> – the prefix to add.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">add_prefix_to_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;data/simple/bla_simple.gtf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">add_prefix_to_file</span><span class="p">(</span><span class="s1">&#39;data/simple/simple.gtf&#39;</span><span class="p">,</span> <span class="s2">&quot;bla_&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.add_r_lib">
<code class="descclassname">pygtftk.utils.</code><code class="descname">add_r_lib</code><span class="sig-paren">(</span><em>cmd=None</em>, <em>libs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.add_r_lib" title="Permalink to this definition">¶</a></dt>
<dd><p>Declare a new set of required R libraries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>libs</strong> – Comma separated list of R libraries.</li>
<li><strong>cmd</strong> – The target command.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_file_or_dir_exists">
<code class="descclassname">pygtftk.utils.</code><code class="descname">check_file_or_dir_exists</code><span class="sig-paren">(</span><em>file_or_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_file_or_dir_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a file/directory or a list of files/directories exist. Raise error if a file is not found.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file_or_dir</strong> – file object or a list of file object.</li>
<li><strong>is_list</strong> – Is file_or_dir a list ?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_file_or_dir_exists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_r_installed">
<code class="descclassname">pygtftk.utils.</code><code class="descname">check_r_installed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_installed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check R is installed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_r_installed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check_r_installed()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.check_r_packages">
<code class="descclassname">pygtftk.utils.</code><code class="descname">check_r_packages</code><span class="sig-paren">(</span><em>r_pkg_list=None</em>, <em>no_error=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if R packages are installed. Return False otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>no_error</strong> – don’t raise an error if some packages are not found.</li>
<li><strong>r_pkg_list</strong> – the list of R packages.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">check_r_packages</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chomp">
<code class="descclassname">pygtftk.utils.</code><code class="descname">chomp</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete carriage return and line feed from end of string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chomp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">NEWLINE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">NEWLINE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chomp</span><span class="p">(</span><span class="s2">&quot;blabla</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chrom_info_as_dict">
<code class="descclassname">pygtftk.utils.</code><code class="descname">chrom_info_as_dict</code><span class="sig-paren">(</span><em>chrom_info_file</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the format of the chromosome info file and return a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chrom_info_file</strong> – A file object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chrom_info_as_dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_as_dict</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;all_chrom&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">900</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.chrom_info_to_bed_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">chrom_info_to_bed_file</code><span class="sig-paren">(</span><em>chrom_file</em>, <em>chr_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_to_bed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bed file (file object) from a chrom info file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>chrom_file</strong> – A file object.</li>
<li><strong>chr_list</strong> – A list of chromosome to be printed to bed file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">chrom_info_to_bed_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pybedtools</span> <span class="k">import</span>  <span class="n">BedTool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_to_bed_file</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">BedTool</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">==</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">==</span> <span class="mi">300</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.close_properly">
<code class="descclassname">pygtftk.utils.</code><code class="descname">close_properly</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.close_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a set of file if they are not None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">close_properly</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.flatten_list">
<code class="descclassname">pygtftk.utils.</code><code class="descname">flatten_list</code><span class="sig-paren">(</span><em>alist</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten a list of lists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alist</strong> – a list or list of list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">])</span> <span class="o">==</span>  <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.flatten_list_recur">
<code class="descclassname">pygtftk.utils.</code><code class="descname">flatten_list_recur</code><span class="sig-paren">(</span><em>a_list</em>, <em>sep=' '</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>Join a list of list.
:param a_list: a list.
:param sep: the separator.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.get_example_feature">
<code class="descclassname">pygtftk.utils.</code><code class="descname">get_example_feature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an example Feature (i.e GTF line).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.get_example_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">get_example_file</code><span class="sig-paren">(</span><em>datasetname='simple'</em>, <em>ext='gtf'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to a gtf file example located in pygtftk library path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>datasetname</strong> – The name of the dataset. One of ‘simple’, ‘mini_real’, ‘simple_02, ‘simple_03’.</li>
<li><strong>ext</strong> – Extension. For ‘simple’ dataset, can be one of ‘bam’,     ‘bam.bai’, ‘bw’, ‘fa’, ‘fa.fai’, ‘chromInfo’, ‘bt*’, ‘fq’, ‘gtf’ or ‘.*’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gtf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bam&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bam&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bw&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bw&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.head_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">head_file</code><span class="sig-paren">(</span><em>afile=None</em>, <em>nb_line=6</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.head_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the first lines of a file (debug).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>afile</strong> – an input file.</li>
<li><strong>nb_line</strong> – the number of lines to print.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">head_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#head_file(my_file)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.intervals">
<code class="descclassname">pygtftk.utils.</code><code class="descname">intervals</code><span class="sig-paren">(</span><em>l</em>, <em>n</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of tuple that correspond to n ~ equally spaced intervals
between 0 and l. Note that n must be lower than len(l).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>silent</strong> – use a silent mode.</li>
<li><strong>l</strong> – a range</li>
<li><strong>n</strong> – number of equally spaced intervals.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span>  <span class="n">intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_comment">
<code class="descclassname">pygtftk.utils.</code><code class="descname">is_comment</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Check wether a string is a comment (starts with #…).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> – The string to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_comment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_comment</span><span class="p">(</span><span class="s2">&quot;#bla&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_empty">
<code class="descclassname">pygtftk.utils.</code><code class="descname">is_empty</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the string empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> – The string to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_empty</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_empty</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_exon">
<code class="descclassname">pygtftk.utils.</code><code class="descname">is_exon</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_exon" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the string contains ‘exon’ preceded or not by spaces.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> – The string to be tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_exon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;Exon&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.is_fasta_header">
<code class="descclassname">pygtftk.utils.</code><code class="descname">is_fasta_header</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_fasta_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the line is a fasta header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> – a character string.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">is_fasta_header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_fasta_header</span><span class="p">(</span><span class="s2">&quot;&gt;DFTDFTD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.make_outdir_and_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">make_outdir_and_file</code><span class="sig-paren">(</span><em>out_dir=None</em>, <em>alist=None</em>, <em>force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_outdir_and_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create output directory and a set of associated files (alist).
Return a list of file handler (write mode) for the requested files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>out_dir</strong> – the directory where file will be located.</li>
<li><strong>alist</strong> – the list of requested file names.</li>
<li><strong>force</strong> – if true, don’t abort if directory already exists.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_outdir_and_file</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.make_tmp_file">
<code class="descclassname">pygtftk.utils.</code><code class="descname">make_tmp_file</code><span class="sig-paren">(</span><em>prefix='tmp'</em>, <em>suffix=''</em>, <em>store=True</em>, <em>dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_tmp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be call to create a temporary file as all files
declared in TMP_FILE_LIST will be remove upon command exit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> – a prefix for the temporary file (all of them will contain ‘pygtftk’).</li>
<li><strong>suffix</strong> – a suffix (default to ‘’).</li>
<li><strong>store</strong> – declare the temporary file in utils.TMP_FILE_LIST. In pygtftk,     the deletion of these files upon exit is controled through -k.</li>
<li><strong>dir</strong> – a target directory.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;pref&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;suf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.median_comp">
<code class="descclassname">pygtftk.utils.</code><code class="descname">median_comp</code><span class="sig-paren">(</span><em>alist</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.median_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the median from a list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alist</strong> – a list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">median_comp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.message">
<code class="descclassname">pygtftk.utils.</code><code class="descname">message</code><span class="sig-paren">(</span><em>msg</em>, <em>nl=True</em>, <em>type='INFO'</em>, <em>force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a formated message on STDERR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>msg</strong> – the message to be send.</li>
<li><strong>nl</strong> – if True, add a newline.</li>
<li><strong>type</strong> – Could be INFO, ERROR, WARNING.</li>
<li><strong>force</strong> – Force message, whatever the verbosity level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.random_string">
<code class="descclassname">pygtftk.utils.</code><code class="descname">random_string</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.random_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random string (alpha numeric) of length n.</p>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.silentremove">
<code class="descclassname">pygtftk.utils.</code><code class="descname">silentremove</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.silentremove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove silently (without error and warning) a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> – a file name (or file object).</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">silentremove</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.simple_line_count">
<code class="descclassname">pygtftk.utils.</code><code class="descname">simple_line_count</code><span class="sig-paren">(</span><em>afile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_line_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of lines in a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>afile</strong> – A file object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.simple_nb_column">
<code class="descclassname">pygtftk.utils.</code><code class="descname">simple_nb_column</code><span class="sig-paren">(</span><em>afile</em>, <em>separator='\t'</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_nb_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the maximum number of columns in a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>separator</strong> – the separator (default ”  “).</li>
<li><strong>afile</strong> – file name.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.sort_2_lists">
<code class="descclassname">pygtftk.utils.</code><code class="descname">sort_2_lists</code><span class="sig-paren">(</span><em>list1</em>, <em>list2</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.sort_2_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort list1 in increasing order and list2 occordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>list1</strong> – the first list.</li>
<li><strong>list2</strong> – the second list.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">sort_2_lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">sort_2_lists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.tab_line">
<code class="descclassname">pygtftk.utils.</code><code class="descname">tab_line</code><span class="sig-paren">(</span><em>token=None</em>, <em>newline=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.tab_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tabulated string from an input list with an optional
newline</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>token</strong> – an input list.</li>
<li><strong>newline</strong> – if True a newline character is added to the string.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">tab_line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tab_line</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;b&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;c&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.to_alphanum">
<code class="descclassname">pygtftk.utils.</code><code class="descname">to_alphanum</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.to_alphanum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new string in which non alphanumeric character have been replaced by ‘_’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> – A character string in which non alphanumeric char have to be replaced.</li>
<li><strong>replacement_list</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>:Example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">to_alphanum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">to_alphanum</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">tf.bla&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;gtf_bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pygtftk.utils.write_properly">
<code class="descclassname">pygtftk.utils.</code><code class="descname">write_properly</code><span class="sig-paren">(</span><em>string</em>, <em>afile</em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.write_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a string to a file. If file is None, write string to stdout.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>string</strong> – a character string.</li>
<li><strong>afile</strong> – a file object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="k">import</span> <span class="n">write_properly</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Help on Python package (pygtftk)</a><ul>
<li><a class="reference internal" href="#module-pygtftk.gtf_interface">The GTF class</a></li>
<li><a class="reference internal" href="#module-pygtftk.fasta_interface">The FASTA class</a></li>
<li><a class="reference internal" href="#module-pygtftk.tab_interface">The TAB class</a></li>
<li><a class="reference internal" href="#module-pygtftk.Line">The Line module</a></li>
<li><a class="reference internal" href="#module-pygtftk.utils">The gtftk.utils module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="presentation.html"
                        title="previous chapter">Help on gtftk Unix commands</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bwig_coverage.html"
                        title="next chapter">The gtftk.bam.bam_coverage_matrix module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The gtftk.bam.bam_coverage_matrix module"
             >next</a> |</li>
        <li class="right" >
          <a href="presentation.html" title="Help on gtftk Unix commands"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 0.9.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, F. Lopez, G. Charbonnier, A. Gonzalez, S. Spicuglia and D. Puthier.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.
    </div>
  </body>
</html>